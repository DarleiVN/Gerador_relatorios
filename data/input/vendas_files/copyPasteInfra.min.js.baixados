var copyPasteInfra;!function(){var e={805:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(e,o,n){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,o){var n=[null];n.push.apply(n,r);var a=new(Function.bind.apply(e,n));return o&&t(a,o.prototype),a},r.apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var a=Object.hasOwnProperty,i=Object.setPrototypeOf,s=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,u=Object.freeze,d=Object.seal,p=Object.create,f="undefined"!=typeof Reflect&&Reflect,m=f.apply,g=f.construct;m||(m=function(e,t,r){return e.apply(t,r)}),u||(u=function(e){return e}),d||(d=function(e){return e}),g||(g=function(e,t){return r(e,o(t))});var h,y=I(Array.prototype.forEach),b=I(Array.prototype.pop),S=I(Array.prototype.push),_=I(String.prototype.toLowerCase),C=I(String.prototype.toString),w=I(String.prototype.match),E=I(String.prototype.replace),v=I(String.prototype.indexOf),T=I(String.prototype.trim),P=I(RegExp.prototype.test),A=(h=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(h,t)});function I(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return m(e,t,o)}}function M(e,t,r){var o;r=null!==(o=r)&&void 0!==o?o:_,i&&i(e,null);for(var n=t.length;n--;){var a=t[n];if("string"==typeof a){var c=r(a);c!==a&&(s(t)||(t[n]=c),a=c)}e[a]=!0}return e}function x(e){var t,r=p(null);for(t in e)!0===m(a,e,[t])&&(r[t]=e[t]);return r}function k(e,t){for(;null!==e;){var r=l(e,t);if(r){if(r.get)return I(r.get);if("function"==typeof r.value)return I(r.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var O=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),F=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),j=u(["#text"]),$=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),N=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),U=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),J=d(/<%[\w\W]*|[\w\W]*%>/gm),G=d(/\${[\w\W]*}/gm),V=d(/^data-[\-\w.\u00B7-\uFFFF]/),B=d(/^aria-[\-\w]+$/),K=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=d(/^(?:\w+script|data):/i),Z=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=d(/^html$/i),Y=d(/^[a-z][.\w]*(-[.\w]+)+$/i);return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=function(e){return t(e)};if(n.version="2.5.7",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var a=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,d=r.Element,p=r.NodeFilter,f=r.NamedNodeMap,m=void 0===f?r.NamedNodeMap||r.MozNamedAttrMap:f,g=r.HTMLFormElement,h=r.DOMParser,I=r.trustedTypes,Q=d.prototype,ee=k(Q,"cloneNode"),te=k(Q,"nextSibling"),re=k(Q,"childNodes"),oe=k(Q,"parentNode");if("function"==typeof c){var ne=i.createElement("template");ne.content&&ne.content.ownerDocument&&(i=ne.content.ownerDocument)}var ae=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,n="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(n)&&(o=r.currentScript.getAttribute(n));var a="dompurify"+(o?"#"+o:"");try{return t.createPolicy(a,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(I,a),ie=ae?ae.createHTML(""):"",se=i,ce=se.implementation,le=se.createNodeIterator,ue=se.createDocumentFragment,de=se.getElementsByTagName,pe=a.importNode,fe={};try{fe=x(i).documentMode?i.documentMode:{}}catch(e){}var me={};n.isSupported="function"==typeof oe&&ce&&void 0!==ce.createHTMLDocument&&9!==fe;var ge,he,ye=z,be=J,Se=G,_e=V,Ce=B,we=q,Ee=Z,ve=Y,Te=K,Pe=null,Ae=M({},[].concat(o(O),o(L),o(W),o(F),o(j))),Ie=null,Me=M({},[].concat(o($),o(N),o(U),o(H))),xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,Oe=null,Le=!0,We=!0,Re=!1,Fe=!0,De=!1,je=!0,$e=!1,Ne=!1,Ue=!1,He=!1,ze=!1,Je=!1,Ge=!0,Ve=!1,Be=!0,Ke=!1,qe={},Ze=null,Xe=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ye=null,Qe=M({},["audio","video","img","source","image","track"]),et=null,tt=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",ot="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",at=nt,it=!1,st=null,ct=M({},[rt,ot,nt],C),lt=["application/xhtml+xml","text/html"],ut=null,dt=i.createElement("form"),pt=function(e){return e instanceof RegExp||e instanceof Function},ft=function(t){ut&&ut===t||(t&&"object"===e(t)||(t={}),t=x(t),ge=ge=-1===lt.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===ge?C:_,Pe="ALLOWED_TAGS"in t?M({},t.ALLOWED_TAGS,he):Ae,Ie="ALLOWED_ATTR"in t?M({},t.ALLOWED_ATTR,he):Me,st="ALLOWED_NAMESPACES"in t?M({},t.ALLOWED_NAMESPACES,C):ct,et="ADD_URI_SAFE_ATTR"in t?M(x(tt),t.ADD_URI_SAFE_ATTR,he):tt,Ye="ADD_DATA_URI_TAGS"in t?M(x(Qe),t.ADD_DATA_URI_TAGS,he):Qe,Ze="FORBID_CONTENTS"in t?M({},t.FORBID_CONTENTS,he):Xe,ke="FORBID_TAGS"in t?M({},t.FORBID_TAGS,he):{},Oe="FORBID_ATTR"in t?M({},t.FORBID_ATTR,he):{},qe="USE_PROFILES"in t&&t.USE_PROFILES,Le=!1!==t.ALLOW_ARIA_ATTR,We=!1!==t.ALLOW_DATA_ATTR,Re=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Fe=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,De=t.SAFE_FOR_TEMPLATES||!1,je=!1!==t.SAFE_FOR_XML,$e=t.WHOLE_DOCUMENT||!1,He=t.RETURN_DOM||!1,ze=t.RETURN_DOM_FRAGMENT||!1,Je=t.RETURN_TRUSTED_TYPE||!1,Ue=t.FORCE_BODY||!1,Ge=!1!==t.SANITIZE_DOM,Ve=t.SANITIZE_NAMED_PROPS||!1,Be=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,at=t.NAMESPACE||nt,xe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&pt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&pt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(We=!1),ze&&(He=!0),qe&&(Pe=M({},o(j)),Ie=[],!0===qe.html&&(M(Pe,O),M(Ie,$)),!0===qe.svg&&(M(Pe,L),M(Ie,N),M(Ie,H)),!0===qe.svgFilters&&(M(Pe,W),M(Ie,N),M(Ie,H)),!0===qe.mathMl&&(M(Pe,F),M(Ie,U),M(Ie,H))),t.ADD_TAGS&&(Pe===Ae&&(Pe=x(Pe)),M(Pe,t.ADD_TAGS,he)),t.ADD_ATTR&&(Ie===Me&&(Ie=x(Ie)),M(Ie,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&M(et,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Ze===Xe&&(Ze=x(Ze)),M(Ze,t.FORBID_CONTENTS,he)),Be&&(Pe["#text"]=!0),$e&&M(Pe,["html","head","body"]),Pe.table&&(M(Pe,["tbody"]),delete ke.tbody),u&&u(t),ut=t)},mt=M({},["mi","mo","mn","ms","mtext"]),gt=M({},["annotation-xml"]),ht=M({},["title","style","font","a","script"]),yt=M({},L);M(yt,W),M(yt,R);var bt=M({},F);M(bt,D);var St=function(e){S(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ie}catch(t){e.remove()}}},_t=function(e,t){try{S(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){S(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ie[e])if(He||ze)try{St(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ct=function(e){var t,r;if(Ue)e="<remove></remove>"+e;else{var o=w(e,/^[\r\n\t ]+/);r=o&&o[0]}"application/xhtml+xml"===ge&&at===nt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var n=ae?ae.createHTML(e):e;if(at===nt)try{t=(new h).parseFromString(n,ge)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(at,"template",null);try{t.documentElement.innerHTML=it?ie:n}catch(e){}}var a=t.body||t.documentElement;return e&&r&&a.insertBefore(i.createTextNode(r),a.childNodes[0]||null),at===nt?de.call(t,$e?"html":"body")[0]:$e?t.documentElement:a},wt=function(e){return le.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null,!1)},Et=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof m)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},vt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Tt=function(e,t,r){me[e]&&y(me[e],(function(e){e.call(n,t,r,ut)}))},Pt=function(e){var t;if(Tt("beforeSanitizeElements",e,null),Et(e))return St(e),!0;if(P(/[\u0080-\uFFFF]/,e.nodeName))return St(e),!0;var r=he(e.nodeName);if(Tt("uponSanitizeElement",e,{tagName:r,allowedTags:Pe}),e.hasChildNodes()&&!vt(e.firstElementChild)&&(!vt(e.content)||!vt(e.content.firstElementChild))&&P(/<[/\w]/g,e.innerHTML)&&P(/<[/\w]/g,e.textContent))return St(e),!0;if("select"===r&&P(/<template/i,e.innerHTML))return St(e),!0;if(7===e.nodeType)return St(e),!0;if(je&&8===e.nodeType&&P(/<[/\w]/g,e.data))return St(e),!0;if(!Pe[r]||ke[r]){if(!ke[r]&&It(r)){if(xe.tagNameCheck instanceof RegExp&&P(xe.tagNameCheck,r))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))return!1}if(Be&&!Ze[r]){var o=oe(e)||e.parentNode,a=re(e)||e.childNodes;if(a&&o)for(var i=a.length-1;i>=0;--i){var s=ee(a[i],!0);s.__removalCount=(e.__removalCount||0)+1,o.insertBefore(s,te(e))}}return St(e),!0}return e instanceof d&&!function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:at,tagName:"template"});var r=_(e.tagName),o=_(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===ot?t.namespaceURI===nt?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===o||mt[o]):Boolean(yt[r]):e.namespaceURI===rt?t.namespaceURI===nt?"math"===r:t.namespaceURI===ot?"math"===r&&gt[o]:Boolean(bt[r]):e.namespaceURI===nt?!(t.namespaceURI===ot&&!gt[o])&&!(t.namespaceURI===rt&&!mt[o])&&!bt[r]&&(ht[r]||!yt[r]):!("application/xhtml+xml"!==ge||!st[e.namespaceURI]))}(e)?(St(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!P(/<\/no(script|embed|frames)/i,e.innerHTML)?(De&&3===e.nodeType&&(t=e.textContent,t=E(t,ye," "),t=E(t,be," "),t=E(t,Se," "),e.textContent!==t&&(S(n.removed,{element:e.cloneNode()}),e.textContent=t)),Tt("afterSanitizeElements",e,null),!1):(St(e),!0)},At=function(e,t,r){if(Ge&&("id"===t||"name"===t)&&(r in i||r in dt))return!1;if(We&&!Oe[t]&&P(_e,t));else if(Le&&P(Ce,t));else if(!Ie[t]||Oe[t]){if(!(It(e)&&(xe.tagNameCheck instanceof RegExp&&P(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&P(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&P(xe.tagNameCheck,r)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))))return!1}else if(et[t]);else if(P(Te,E(r,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==v(r,"data:")||!Ye[e])if(Re&&!P(we,E(r,Ee,"")));else if(r)return!1;return!0},It=function(e){return"annotation-xml"!==e&&w(e,ve)},Mt=function(t){var r,o,a,i;Tt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ie};for(i=s.length;i--;){var l=r=s[i],u=l.name,d=l.namespaceURI;if(o="value"===u?r.value:T(r.value),a=he(u),c.attrName=a,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,Tt("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(_t(u,t),c.keepAttr))if(Fe||!P(/\/>/i,o)){De&&(o=E(o,ye," "),o=E(o,be," "),o=E(o,Se," "));var p=he(t.nodeName);if(At(p,a,o))if(!Ve||"id"!==a&&"name"!==a||(_t(u,t),o="user-content-"+o),je&&P(/((--!?|])>)|<\/(style|title)/i,o))_t(u,t);else{if(ae&&"object"===e(I)&&"function"==typeof I.getAttributeType)if(d);else switch(I.getAttributeType(p,a)){case"TrustedHTML":o=ae.createHTML(o);break;case"TrustedScriptURL":o=ae.createScriptURL(o)}try{d?t.setAttributeNS(d,u,o):t.setAttribute(u,o),Et(t)?St(t):b(n.removed)}catch(e){}}}else _t(u,t)}Tt("afterSanitizeAttributes",t,null)}},xt=function e(t){var r,o=wt(t);for(Tt("beforeSanitizeShadowDOM",t,null);r=o.nextNode();)Tt("uponSanitizeShadowNode",r,null),Pt(r)||(r.content instanceof s&&e(r.content),Mt(r));Tt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(t){var o,i,c,u,d,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!vt(t)){if("function"!=typeof t.toString)throw A("toString is not a function");if("string"!=typeof(t=t.toString()))throw A("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(vt(t))return r.toStaticHTML(t.outerHTML)}return t}if(Ne||ft(p),n.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var f=he(t.nodeName);if(!Pe[f]||ke[f])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(i=(o=Ct("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?o=i:o.appendChild(i);else{if(!He&&!De&&!$e&&-1===t.indexOf("<"))return ae&&Je?ae.createHTML(t):t;if(!(o=Ct(t)))return He?null:Je?ie:""}o&&Ue&&St(o.firstChild);for(var m=wt(Ke?t:o);c=m.nextNode();)3===c.nodeType&&c===u||Pt(c)||(c.content instanceof s&&xt(c.content),Mt(c),u=c);if(u=null,Ke)return t;if(He){if(ze)for(d=ue.call(o.ownerDocument);o.firstChild;)d.appendChild(o.firstChild);else d=o;return(Ie.shadowroot||Ie.shadowrootmod)&&(d=pe.call(a,d,!0)),d}var g=$e?o.outerHTML:o.innerHTML;return $e&&Pe["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&P(X,o.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+g),De&&(g=E(g,ye," "),g=E(g,be," "),g=E(g,Se," ")),ae&&Je?ae.createHTML(g):g},n.setConfig=function(e){ft(e),Ne=!0},n.clearConfig=function(){ut=null,Ne=!1},n.isValidAttribute=function(e,t,r){ut||ft({});var o=he(e),n=he(t);return At(o,n,r)},n.addHook=function(e,t){"function"==typeof t&&(me[e]=me[e]||[],S(me[e],t))},n.removeHook=function(e){if(me[e])return b(me[e])},n.removeHooks=function(e){me[e]&&(me[e]=[])},n.removeAllHooks=function(){me={}},n}()}()},971:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},33:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const n="undefined"!=typeof performance?performance:void 0;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*n.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},819:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},234:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=void 0;const o=r(107);t.Wp=o;const n=r(960);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return n.LogCategory}}),r(971);const a=r(180);t.TZ=a;r(765),r(726);r(33),r(792),r(819)},960:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,n)=>t.traceTag(e,r,o,n),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,n)=>t.debugTraceTag(e,r,o,n),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,n)=>t.assertTag(e,r,o,n),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,n)=>t.shipAssertTag(e,r,o,n),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,n)=>t.dnmTraceTag(e,r,o,n)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},180:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),n=e,a=t,i={},s=(e,t,r)=>function(e,t,r,n,a,i){o(e,"end",r);const s={sessionName:t,result:n?"success":"failure",message:i,marks:e};a(JSON.stringify(s))}(i,n,a,e,t,r);return i.start=0,{mark:e=>(e=>o(i,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},792:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},765:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let n=r(),a=o;return{reset(e){null!=e&&(a=e),n=r()},stop(o){const i=r()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},726:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},107:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const n=e[o];r=r.catch((()=>t(n)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));let n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const n={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const i={};return Object.keys(n).forEach((e=>{i[e]=o(n[e],t+1)})),i}const n="_",a=new RegExp("\\W+","g")},621:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},662:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let a=[];for(let e=0;e<=n.length;++e)a[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[n.length]}},227:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(662),n={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const i=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&i.push(e);return i.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(227),t),o.__exportStar(r(342),t),o.__exportStar(r(621),t),o.__exportStar(r(915),t),o.__exportStar(r(237),t),o.__exportStar(r(27),t)},342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(227)},915:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(621)},237:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(621);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},27:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(227);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},996:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.domPurifyIsValidAttribute=t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.bypassPolicy=t.setRuntimeAllowedOrigins=t.urlOriginPolicy=t.emptyStringPolicyURL=t.emptyStringPolicyHTML=t.domPurifyPolicyHtml=void 0;var o=r(267);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return o.domPurifyPolicyHtml}});var n=r(401);Object.defineProperty(t,"emptyStringPolicyHTML",{enumerable:!0,get:function(){return n.emptyStringPolicyHTML}}),Object.defineProperty(t,"emptyStringPolicyURL",{enumerable:!0,get:function(){return n.emptyStringPolicyURL}});var a=r(591);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return a.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOrigins",{enumerable:!0,get:function(){return a.setRuntimeAllowedOrigins}});var i=r(653);Object.defineProperty(t,"bypassPolicy",{enumerable:!0,get:function(){return i.bypassPolicy}});var s=r(59);Object.defineProperty(t,"createTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return s.createTrustedTypesDefaultPolicy}}),Object.defineProperty(t,"createGraphicsEditorTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return s.createGraphicsEditorTrustedTypesDefaultPolicy}});var c=r(52);Object.defineProperty(t,"domPurifyIsValidAttribute",{enumerable:!0,get:function(){return c.domPurifyIsValidAttribute}});var l=r(893);Object.defineProperty(t,"uuidStringPolicyHTML",{enumerable:!0,get:function(){return l.uuidStringPolicyHTML}})},561:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o,a)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){a?.(`${e}`)}return r[e]}},653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const o=r(561);t.createBypassPolicy=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},59:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const o=r(645),n=r(561),a=r(52),i=r(591);t.createDefaultPolicyInternal=(e,t)=>{(0,n.createPolicy)("default",{createHTML:(e,r,o)=>{try{if("Element innerHTML"===o&&ee(W,h))return te.has(e)?e:(0,a.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===o&&ee(D,y)||"Element setAttribute"===o&&ee(K,w))return e}catch(e){t?.(`${e}`)}},createScript:(e,r,n)=>{try{if("eval"===n&&ee($,S))return e;if("HTMLScriptElement text"===n&&ee(Z,C)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,o.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===n&&ee(void 0,E))return e}catch(e){t?.(`${e}`)}},createScriptURL:(e,r,o)=>{try{if("Worker constructor"===o&&ee(X,b)||"HTMLScriptElement src"===o&&ee(B,_)){const{origin:t}=new URL(e,document.baseURI);if((0,i.isAnAllowedOrigin)(t))return e}}catch(e){t?.(`${e}`)}}},e,t)},t.createTrustedTypesDefaultPolicy=e=>(0,t.createDefaultPolicyInternal)(void 0,e),t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(I,h))return(0,a.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const s=/https?:\/\/[^\s/$.?#].[^\s]*/g,c=/\/officeonline\/versioned\/mathjax\-lowercase\-patched\/\d{1,10}\.\d{1,10}\.\d{1,10}\/mathjax\/\d{1,10}\.\d{1,10}\.\d{1,10}\/(config\/|jax\/output\/html\-css\/)?/,l=/\/(officeonline\/)?o\/s\/h?([0-9a-fA-F])+_app_scripts\/(wp5\/)?/,u=/\/(officeonline\/)?x\/s\/h?([0-9a-fA-F])+__layouts\/app_scripts\/((wp5|ac|cc|es6|rslc\d+|)\/)?/,d=/\/1js\/(build|pr)\/[0-9a-fA-F]+/,p=/\/wd1js\/(ship|debug)\/(we|wv|x)\/(_layouts\/)?app_scripts\/((wp5|ac|cc|es6|rslc\d+)\/)?/,f=/\/wo\/webpack\/((wp5|ac|cc|es6|rslc\d+)\/)?/,m=/\/officeonline\/pods\/s\/(h[0-9a-fA-F]+|\d+)_(app_scripts|pptscripts)\/?/,g=new RegExp(`(${/\/officeonline\/hashed\/[0-9a-fA-F]+\//.source}|${l.source}|${u.source}|${d.source}(${p.source}|${f.source}|/lib-es5/)|${m.source})`),h=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\-]){0,10}|jquery(\.signalr\.merge\.\d+\.\d+\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\.debug)?\.(core\.common|core1|core2|core3|precore)|(\@1js\/oscui\-compact\-quill\@\d{1,10}\.\d{1,10}\.\d{1,10}\/[A-Za-z0-9-]+\/v\d{1,10}\/bundled\/dist\/quill\.custom))\.(min\.)?js/,y=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\.min)?\.js(\:|$)/,b=/(wordeditords(eagercompile|separatedialog|\.debug)?\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\.min)?\.js/,S=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\.debug)?\.core3)\.(min\.)?js/,_=/(dime|wacboot|officewebsurfaces\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore))(\.min)?\.js/,C=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\.box4\.dll1)?)(\.min)?\.js/,w=/(common|copilotcommonux)\.(min\.)?js/,E=/(officebrowserfeedback_floodgate)\.(min\.)?js/,v=new RegExp(`(${g.source})(common|common50|commonux([0-9a-fA-F]|\\-){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\.(min\\.)?js`),T=new RegExp(`${c.source}(mathjax|jax|mml_htmlormml)\\.js`),P=new RegExp(`${l.source}mathjax/(mathjax)\\.js`),A=new RegExp("/scripts/me/mecontrol/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),I=new RegExp(`(/officeonline/versioned/host-word/\\d{1,4}\\.\\d{1,2}\\.\\d{1,2}/|${m.source}|${d.source}(${p.source}|${f.source}|/lib-es5/))(gc2|gc2host)\\.(min\\.)?js`),M=new RegExp(`(${u.source}|${d.source}(${p.source}|${f.source}|/lib-es5/))(gc2host)\\.(min\\.)?js`),x=new RegExp(`(${m.source})(pptedit(ds)?\\.precore)\\.(min\\.)?js`),k=new RegExp(`(${m.source})(pptedit(ds)?\\.core\\.common)\\.(min\\.)?js`),O=new RegExp(`(${m.source})(immersivereader)\\.(min\\.)?js`),L=new RegExp(`(${m.source})(pptedit(ds)?\\.(core1|core2|core3))\\.(min\\.)?js`),W=new RegExp(`(${v.source})|(${T.source})|(${P.source})|(${A.source})|(${I.source})|(${M.source})|(${x.source})|(${k.source})|(${O.source})|(${L.source})`),R=new RegExp(`(${g.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\.(min\\.)?js(\\:|$)`),F=new RegExp(`${c.source}mml_htmlormml.js`),D=new RegExp(`(${R.source})|(${F.source})`),j=new RegExp(`(${u.source}|${d.source}(${p.source}|${f.source}))feedback/officebrowserfeedback_floodgate\\.(min\\.)?js`),$=new RegExp(`((${g.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\.(min\\.)?js)|(${j.source})`),N=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\.core\\.(min\\.)?js"),U=new RegExp(`(${g.source}(lpplazy|midgardbootstrapper)|(${c.source}mathjax))\\.(min\\.)?js`),H=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\.(min\\.)?js"),z=new RegExp("/dime/v1/dime\\.js"),J=new RegExp(`(${g.source}(mathjax/mathjax\\.js))`),G=new RegExp(`(${g.source}(pptedit(?:ds)?\\.(precore|core1|core2|core3)\\.js))`),V=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\.js"),B=new RegExp(`${N.source}|${U.source}|${H.source}|${z.source}|${J.source}|${G.source}|${V.source}`),K=new RegExp(`(${g.source})(common|copilotcommonux)\\.(min\\.)?js`),q=new RegExp(`${c.source}mathjax.js`),Z=new RegExp(`((${g.source})wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?\\.js)|(${q.source})`),X=new RegExp(`(${g.source})(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\.(min\\.)?js`),Y=e=>"https://amcdn.msftauth.net"===e||(0,i.isAnAllowedOrigin)(e),Q=e=>i.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const o=r.stack.match(s);if(!o?.length)return!1;for(const r of o)try{const{origin:o,pathname:n}=new URL(r);if(!Y(o))continue;const a=n.toLowerCase(),i=Q(o)&&t?.test(a),s=e?.test(a);if(s||i)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href='#'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},371:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\"alert('XSS')\"></div>",maliciousSVG:'<svg><circle cx="50" cy="50" r="40" onclick="alert(\'XSS\')"></circle></svg>',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\"alert('XSS')\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:'<svg><circle r="40" cy="50" cx="50"></circle></svg>',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:['<div paraid="example"></div>','<div lang="en"></div>'],missingTagsHTML:['<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>',"\x3c!-- This is a comment --\x3e<div>Content</div>"]}},267:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const o=r(561),n=r(52);t.createDomPurifyPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:(e,t,r)=>(0,n.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},52:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const o=r(533),n=r(805),a=o.__importStar(r(371));t.sanitizedHTMLAndValidate=(e,t,r)=>{let o=!1;const i=t?(e=>({...a.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):a.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,n.addHook)(e,t)}));const s=(0,n.sanitize)(e,i);return r&&Object.entries(r).forEach((([e])=>{(0,n.removeHooks)(e)})),t?.USE_PROFILES?s:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=a.htmlBlockListAttributes.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=a.htmlBlockList.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(n.removed),o?e:s)},t.domPurifyIsValidAttribute=n.isValidAttribute},401:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const o=r(561);t.createEmptyStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML"),t.createEmptyStringPolicyURL=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.bbRunsRegex=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const o=r(561),n=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let a=[];t.setRuntimeAllowedOrigins=e=>{a=a.concat(e)};const i=[/^https?:\/\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel|visio)\.officeapps\.live\.com$/],s=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),t.bbRunsRegex=new RegExp("^https?://[\\w-]+\\.pyxidis\\.off(:\\d+)?$"),t.isAnAllowedOrigin=e=>n.includes(e)||a.includes(e)||i.some((t=>t.test(e)))||s.some((t=>t.test(e)))||t.localhostRegex.test(e)||t.bbRunsRegex.test(e),t.createUrlOriginPolicy=(e,r)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const o=r(561);t.createUUIDStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},713:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,n(r(325),t);var a=r(197);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return a.createWorker}})},325:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=t.setUpTrustedTypesConfig=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var o=r(489);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return o.WorkerError}});var n=r(615);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return n.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return n.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return n.dispatchWorkerError}});var a=r(487);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return a.paramInsideDef}});var i=r(984);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return i.Endpoint}});var s=r(222);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var c=r(733);Object.defineProperty(t,"setUpTrustedTypesConfig",{enumerable:!0,get:function(){return c.setUpTrustedTypesConfig}});var l=r(158);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return l.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return l.workerName}})},615:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(c)throw new TypeError("setConfig has already been called");c=e},t.getSafeParams=function(){const e=c??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??c?.createTimeout??n},t.getCreateMode=function(e){const t=e?.createMode??c?.createMode??a;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(c?.onWorkerError??d)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(c?.onCreateWorker??p)(e)}catch(e){l(e)}};const o=r(471),n=3e5,a="Thread";var i;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let c;function l(e){setTimeout((()=>{throw e}))}function u(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function d(e){const t=u();if(void 0!==t){const r={kind:i.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function p(e){const t=u();if(void 0!==t){const r={kind:i.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(i||(t.ThreadMessageKind=i={}))},197:function(e,t,r){"use strict";var o,n=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=b;const s=r(615),c=r(984),l=r(111),u=r(487),d=r(6),p=r(901),f=r(489),m={...i(r(325)),createWorker:b};function g(e,t,r,o,n){const{port1:a,port2:i}=new MessageChannel;let s;return Promise.all([o({port:a,options:e,createMode:t}),(0,d.timePromise)(r.createOutside=(0,d.startStopwatch)(),(()=>c.Endpoint.createOutside({port:i,options:e,createMode:t},(e=>n(s=e)))))]).then((()=>s),(e=>(s?s.close("Force"):i.close(),Promise.reject(e))))}function h(e,t,r,o){return g(e,"Local",t,(e=>function(e,t,r){const{def:o,args:n}="def"in r?r:(0,u.paramInsideDef)(r);if("function"!=typeof o){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new f.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,d.timePromise)(t.insideInit=(0,d.startStopwatch)(),(()=>o({config:(0,s.getSafeParams)(),importTypedWorkers:()=>m,connection:e},...n).then((()=>{}))))))}(e,t,r)),o)}function y(e,t,r,o){let n;t.createThread=(0,d.startStopwatch)();try{n=new p.Thread(e,r)}catch(e){return(0,d.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,d.stopStopwatch)(t.createThread,"Success"),g(e,"Thread",t,(e=>n.createInside(e,t)),o).then((e=>(e.hasBeenClosed()?n.terminate():e._onClose=n.terminate.bind(n),e)),(e=>(n.terminate(),Promise.reject(e))))}function b(e,t,r=(()=>{})){const o=(0,s.getCreateMode)(e),n="local"in t?"Local"===o?t.local:t.thread:t,a="Local"===o?h:y,i={id:e.id,createMode:o,createWorker:(0,d.startStopwatch)()},u=(0,d.timePromise)(i.createWorker,(()=>a((0,c.getSafeOptions)(e),i,n,r)));return(0,l.promiseFinally)(u,(()=>{const e=(0,d.createWorkerStats)(i);e&&(0,s.dispatchCreateWorker)(e)}))}},984:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0,t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries,isTrustedTypesPolicyEnabled:e.isTrustedTypesPolicyEnabled}};const o=r(615),n=r(691),a=r(471),i=r(111),s=r(489);class c{static _create(e,t,r){const{port:a,options:l,createMode:u}=t,d={type:"Endpoint",side:e,id:l?.id};let p,f;try{p=new n.EndpointState(d,a),f=new c(d,p,u)}catch(e){return Promise.reject(e)}return new Promise(((t,n)=>{p.getCallTimeout=()=>f.callTimeout,p.getOnPostMessageError=()=>f.onPostMessageError,p.onImports=(e,t)=>{Object.defineProperties(f,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),c.resolve()},p.onClose=()=>f.close("Force");const a=(0,o.getCreateTimeout)(l),c=(0,i.setCallbacksTimeout)(a,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:d,timeout:a},o=new s.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);c.reject(o)}),{resolve:t,reject:n});let u;f._closedDuringCreate=()=>{c.resolve()};try{u=r(f)}catch(e){return c.reject(e)}f._state?.setExports(u)})).then((()=>(f._closedDuringCreate=void 0,f)),(e=>(f._closedDuringCreate=void 0,f.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new s.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,o.dispatchWorkerError)(new s.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=n.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const o=t=>()=>{const r="Outside"===e.side?"inside":"outside",o={cause:"Connection",idInfo:e};throw new s.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,o)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:o("post")},call:{configurable:!0,enumerable:!1,get:o("call")}})}}t.Endpoint=c,c.createOutside=(e,t=(()=>{}))=>c._create("Outside",e,t),c.createInside=(e,t)=>c._create("Inside",e,t)},691:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=void 0,t.throwWorkerError=c;const o=r(615),n=r(471),a=r(111),i=r(489);var s;function c(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(s||(s={}));let l=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,a.haveNativeProxy)()?void 0:(0,a.getFunctionPropertyNames)(e),r={kind:s.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:s.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],o={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new i.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,o))}}onInvoke({callId:e,funcName:t,args:r}){const a=Promise.resolve().then((()=>{const o=this.exports[t];if(o)return o.apply(this.exports,r);const n=e>=0?"call":"post",a={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new i.WorkerError(`Exporting Endpoint received a ${n} to unknown function ${t}`,a)}));e>=0?a.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):a.catch((r=>{const a=(0,n.asError)(r),s={cause:"UnhandledError",idInfo:this.idInfo,error:a,callId:e,funcName:t};(0,o.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,s))}))}sendResult(e,t,r,o){const a=(0,n.encodeResultValue)(o),i={kind:s.Result,callId:e,funcName:t,isFulfilled:r,resultValue:a};try{this.port.postMessage(i,void 0)}catch(e){this.onSendResultFailed(i,(0,n.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},n){const a=n?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,s={cause:"MessageError",idInfo:this.idInfo,error:n,callId:e,funcName:t},c=new i.WorkerError(a,s);r.isError?(0,o.dispatchWorkerError)(c):this.sendResult(e,t,!1,c)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,o){return r>a.maxTimeout?o:(0,a.setCallbacksTimeout)(r,(()=>{const o=this.takeCallbacks(e);if(o){const n={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};o.reject(new i.WorkerError(`Importing Endpoint's call to ${t} timed out`,n))}}),o)}sendCall(e,t,r,o){return new Promise(((a,c)=>{const u=l+=1,d={kind:s.Invoke,callId:u,funcName:e,args:t};this.unresolvedCalls[u]={...this.setCallTimeout(u,e,r,{resolve:a,reject:c}),funcName:e};try{this.port.postMessage(d,o)}catch(t){const r=this.takeCallbacks(u);if(r){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:u,funcName:e};r.reject(new i.WorkerError(`Importing Endpoint failed to send call to ${e}`,a))}}}))}sendPost(e,t,r,o){const a={kind:s.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,o)}catch(t){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new i.WorkerError(`Importing Endpoint failed to post to ${e}`,a))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",n={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},a=new i.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,n),s=e>=0?this.takeCallbacks(e):void 0;(s?.reject??o.dispatchWorkerError)(a)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:n}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,i.decodeResultValue)(n))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,o.dispatchWorkerError)(new i.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed)return;const n=t.onPostMessageError??this.getOnPostMessageError?.()??c;this.sendPost(e,o,n,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new i.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const n=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,o,n,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,a.createEmptyRecord)();const r=()=>this.onClose?.(),o={[s.Invoke]:this.onInvoke.bind(this),[s.Result]:this.onResult.bind(this),[s.Names]:({funcNames:e})=>{this.onImports?.((0,a.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,a.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[s.Close]:r},n={[s.Invoke]:this.onSendInvokeFailed.bind(this),[s.Result]:this.onSendResultFailed.bind(this),[s.Names]:r,[s.Close]:r};this.port.onmessage=({data:e})=>o[e.kind](e),this.port.onmessageerror=({data:e})=>n[e.kind](e)}}},471:function(e,t){"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function n(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?n(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=n,t.encodeError=a,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},111:function(e,t){"use strict";function r(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let o;Object.defineProperty(t,"__esModule",{value:!0}),t.maxTimeout=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.setCallbacksTimeout=function(e,r,o){if(e>t.maxTimeout)return o;const n=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(n),o.resolve(e)},reject:e=>{clearTimeout(n),o.reject(e)}}},t.createEmptyRecord=r,t.getFunctionPropertyNames=function(e){const t=r();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch{}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return o??(o=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch{return!1}}())},t.createObjectFromFunction=function(e,t){const o=r(),n=(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r));return t?(t.forEach((e=>n(o,e))),o):new Proxy(o,{get:n})},t.maxTimeout=1<<30},222:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)a(r,t);else{const t=(0,o.getTrustedScriptUrls)([...e]);importScripts(...t)}};const o=r(733);function n(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const n=e.slice(0,o+1),a=e.slice(o+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,n+a.join("&")}function a(e,t){let r;for(let a=0;a<=t;a+=1)try{const t=a>0?n(e,"retries",String(a)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},487:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},6:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:n()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:n,createOutside:a,createThread:s}=e,{status:l,start:u,end:d}=o;if("Pending"!==l&&void 0!==d)return{id:t,createMode:r,createWorker:{status:l,absStart:u,duration:i(d-u)},createThread:"Thread"===r?c(s,u,d):void 0,createOutside:c(a,u,d),insideInit:c(n,u,d)}};const o=r(471),n="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??n()))}function i(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function c(e,t,r){const o=s(e?.start??1/0,t,r),n=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(o-t),end:i(n-t),duration:i(n-o)}}},901:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const n=r(645),a=r(615),i=r(111),s=r(487),c=o(r(983)),l=r(733),u=r(489);let d=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:o}=e,s={type:"Thread",side:"Outside",id:o.id},c=this.worker,l=new Promise(((e,i)=>{this.createCallbacks={resolve:e,reject:i};const l={config:(0,a.getSafeParams)(),port:r,options:o,script:this.script,args:this.args,featureGateDictionary:(0,n.getFeatureGateDictionary)(),changeGateDictionary:(0,n.getChangeGateDictionary)()};c.postMessage(l,[r,...this.transferables]),c.onerror=e=>{e.preventDefault();const t=(0,u.getErrorEventWorkerError)(s,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},c.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,u.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,u.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,i.promiseFinally)(l,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;(0,l.setUpTrustedTypesConfig)(e.isTrustedTypesPolicyEnabled),[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:o}="def"in e?e:(0,s.paramInsideDef)(e);if("function"!=typeof t)return[t,r,o,void 0];const n=`__generatedInsideInit${d+=1}`;return[{scriptUrl:void 0,insideInitName:n},r,o,`var ${n} = ${t.toString()};`]}(t);const o=void 0===r?[c.default]:[r,"\n\n",c.default];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));const n={};null!=e.id&&(n.name=e.id);const a=(0,l.getTrustedUrl)(this.blobUrl);this.worker=new Worker(a,n)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},983:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{var e={399:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,n,i){return o=r()?Reflect.construct:function(e,r,o){var n=[null];n.push.apply(n,r);var i=new(Function.bind.apply(e,n));return o&&t(i,o.prototype),i},o.apply(null,arguments)}function n(e){return i(e)||a(e)||c(e)||l()}function i(e){if(Array.isArray(e))return s(e)}function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=Object.hasOwnProperty,f=Object.setPrototypeOf,d=Object.isFrozen,p=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,y=Object.freeze,h=Object.seal,g=Object.create,_="undefined"!=typeof Reflect&&Reflect,b=_.apply,v=_.construct;b||(b=function(e,t,r){return e.apply(t,r)}),y||(y=function(e){return e}),h||(h=function(e){return e}),v||(v=function(e,t){return o(e,n(t))});var w=k(Array.prototype.forEach),T=k(Array.prototype.pop),S=k(Array.prototype.push),E=k(String.prototype.toLowerCase),O=k(String.prototype.toString),P=k(String.prototype.match),x=k(String.prototype.replace),A=k(String.prototype.indexOf),R=k(String.prototype.trim),M=k(RegExp.prototype.test),L=j(TypeError);function k(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return b(e,t,o)}}function j(e){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return v(e,r)}}function C(e,t,r){var o;r=null!==(o=r)&&void 0!==o?o:E,f&&f(e,null);for(var n=t.length;n--;){var i=t[n];if("string"==typeof i){var a=r(i);a!==i&&(d(t)||(t[n]=a),i=a)}e[i]=!0}return e}function N(e){var t,r=g(null);for(t in e)!0===b(u,e,[t])&&(r[t]=e[t]);return r}function D(e,t){for(;null!==e;){var r=m(e,t);if(r){if(r.get)return k(r.get);if("function"==typeof r.value)return k(r.value)}e=p(e)}function o(e){return console.warn("fallback value for",e),null}return o}var I=y(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),U=y(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),F=y(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),H=y(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$=y(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),G=y(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),z=y(["#text"]),W=y(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=y(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=y(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Z=y(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=h(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm),Y=h(/<%[\\w\\W]*|[\\w\\W]*%>/gm),K=h(/\\${[\\w\\W]*}/gm),X=h(/^data-[\\-\\w.\\u00B7-\\uFFFF]/),J=h(/^aria-[\\-\\w]+$/),Q=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i),ee=h(/^(?:\\w+script|data):/i),te=h(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g),re=h(/^html$/i),oe=h(/^[a-z][.\\w]*(-[.\\w]+)+$/i),ne=function(){return"undefined"==typeof window?null:window},ie=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,n="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(n)&&(o=r.currentScript.getAttribute(n));var i="dompurify"+(o?"#"+o:"");try{return t.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne(),r=function(e){return ae(e)};if(r.version="2.5.7",r.removed=[],!t||!t.document||9!==t.document.nodeType)return r.isSupported=!1,r;var o=t.document,i=t.document,a=t.DocumentFragment,c=t.HTMLTemplateElement,s=t.Node,l=t.Element,u=t.NodeFilter,f=t.NamedNodeMap,d=void 0===f?t.NamedNodeMap||t.MozNamedAttrMap:f,p=t.HTMLFormElement,m=t.DOMParser,h=t.trustedTypes,g=l.prototype,_=D(g,"cloneNode"),b=D(g,"nextSibling"),v=D(g,"childNodes"),k=D(g,"parentNode");if("function"==typeof c){var j=i.createElement("template");j.content&&j.content.ownerDocument&&(i=j.content.ownerDocument)}var ce=ie(h,o),se=ce?ce.createHTML(""):"",le=i,ue=le.implementation,fe=le.createNodeIterator,de=le.createDocumentFragment,pe=le.getElementsByTagName,me=o.importNode,ye={};try{ye=N(i).documentMode?i.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof k&&ue&&void 0!==ue.createHTMLDocument&&9!==ye;var ge,_e,be=q,ve=Y,we=K,Te=X,Se=J,Ee=ee,Oe=te,Pe=oe,xe=Q,Ae=null,Re=C({},[].concat(n(I),n(U),n(F),n($),n(z))),Me=null,Le=C({},[].concat(n(W),n(B),n(V),n(Z))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,Ce=null,Ne=!0,De=!0,Ie=!1,Ue=!0,Fe=!1,He=!0,$e=!1,Ge=!1,ze=!1,We=!1,Be=!1,Ve=!1,Ze=!0,qe=!1,Ye="user-content-",Ke=!0,Xe=!1,Je={},Qe=null,et=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tt=null,rt=C({},["audio","video","img","source","image","track"]),ot=null,nt=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),it="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",ct="http://www.w3.org/1999/xhtml",st=ct,lt=!1,ut=null,ft=C({},[it,at,ct],O),dt=["application/xhtml+xml","text/html"],pt="text/html",mt=null,yt=i.createElement("form"),ht=function(e){return e instanceof RegExp||e instanceof Function},gt=function(t){mt&&mt===t||(t&&"object"===e(t)||(t={}),t=N(t),ge=ge=-1===dt.indexOf(t.PARSER_MEDIA_TYPE)?pt:t.PARSER_MEDIA_TYPE,_e="application/xhtml+xml"===ge?O:E,Ae="ALLOWED_TAGS"in t?C({},t.ALLOWED_TAGS,_e):Re,Me="ALLOWED_ATTR"in t?C({},t.ALLOWED_ATTR,_e):Le,ut="ALLOWED_NAMESPACES"in t?C({},t.ALLOWED_NAMESPACES,O):ft,ot="ADD_URI_SAFE_ATTR"in t?C(N(nt),t.ADD_URI_SAFE_ATTR,_e):nt,tt="ADD_DATA_URI_TAGS"in t?C(N(rt),t.ADD_DATA_URI_TAGS,_e):rt,Qe="FORBID_CONTENTS"in t?C({},t.FORBID_CONTENTS,_e):et,je="FORBID_TAGS"in t?C({},t.FORBID_TAGS,_e):{},Ce="FORBID_ATTR"in t?C({},t.FORBID_ATTR,_e):{},Je="USE_PROFILES"in t&&t.USE_PROFILES,Ne=!1!==t.ALLOW_ARIA_ATTR,De=!1!==t.ALLOW_DATA_ATTR,Ie=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ue=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Fe=t.SAFE_FOR_TEMPLATES||!1,He=!1!==t.SAFE_FOR_XML,$e=t.WHOLE_DOCUMENT||!1,We=t.RETURN_DOM||!1,Be=t.RETURN_DOM_FRAGMENT||!1,Ve=t.RETURN_TRUSTED_TYPE||!1,ze=t.FORCE_BODY||!1,Ze=!1!==t.SANITIZE_DOM,qe=t.SANITIZE_NAMED_PROPS||!1,Ke=!1!==t.KEEP_CONTENT,Xe=t.IN_PLACE||!1,xe=t.ALLOWED_URI_REGEXP||xe,st=t.NAMESPACE||ct,ke=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ht(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ht(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(De=!1),Be&&(We=!0),Je&&(Ae=C({},n(z)),Me=[],!0===Je.html&&(C(Ae,I),C(Me,W)),!0===Je.svg&&(C(Ae,U),C(Me,B),C(Me,Z)),!0===Je.svgFilters&&(C(Ae,F),C(Me,B),C(Me,Z)),!0===Je.mathMl&&(C(Ae,$),C(Me,V),C(Me,Z))),t.ADD_TAGS&&(Ae===Re&&(Ae=N(Ae)),C(Ae,t.ADD_TAGS,_e)),t.ADD_ATTR&&(Me===Le&&(Me=N(Me)),C(Me,t.ADD_ATTR,_e)),t.ADD_URI_SAFE_ATTR&&C(ot,t.ADD_URI_SAFE_ATTR,_e),t.FORBID_CONTENTS&&(Qe===et&&(Qe=N(Qe)),C(Qe,t.FORBID_CONTENTS,_e)),Ke&&(Ae["#text"]=!0),$e&&C(Ae,["html","head","body"]),Ae.table&&(C(Ae,["tbody"]),delete je.tbody),y&&y(t),mt=t)},_t=C({},["mi","mo","mn","ms","mtext"]),bt=C({},["annotation-xml"]),vt=C({},["title","style","font","a","script"]),wt=C({},U);C(wt,F),C(wt,H);var Tt=C({},$);C(Tt,G);var St=function(e){var t=k(e);t&&t.tagName||(t={namespaceURI:st,tagName:"template"});var r=E(e.tagName),o=E(t.tagName);return!!ut[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===ct?"svg"===r:t.namespaceURI===it?"svg"===r&&("annotation-xml"===o||_t[o]):Boolean(wt[r]):e.namespaceURI===it?t.namespaceURI===ct?"math"===r:t.namespaceURI===at?"math"===r&&bt[o]:Boolean(Tt[r]):e.namespaceURI===ct?!(t.namespaceURI===at&&!bt[o])&&!(t.namespaceURI===it&&!_t[o])&&!Tt[r]&&(vt[r]||!wt[r]):!("application/xhtml+xml"!==ge||!ut[e.namespaceURI]))},Et=function(e){S(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},Ot=function(e,t){try{S(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){S(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Me[e])if(We||Be)try{Et(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Pt=function(e){var t,r;if(ze)e="<remove></remove>"+e;else{var o=P(e,/^[\\r\\n\\t ]+/);r=o&&o[0]}"application/xhtml+xml"===ge&&st===ct&&(e=\'<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>\'+e+"</body></html>");var n=ce?ce.createHTML(e):e;if(st===ct)try{t=(new m).parseFromString(n,ge)}catch(e){}if(!t||!t.documentElement){t=ue.createDocument(st,"template",null);try{t.documentElement.innerHTML=lt?se:n}catch(e){}}var a=t.body||t.documentElement;return e&&r&&a.insertBefore(i.createTextNode(r),a.childNodes[0]||null),st===ct?pe.call(t,$e?"html":"body")[0]:$e?t.documentElement:a},xt=function(e){return fe.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},At=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Rt=function(t){return"object"===e(s)?t instanceof s:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Mt=function(e,t,o){he[e]&&w(he[e],(function(e){e.call(r,t,o,mt)}))},Lt=function(e){var t;if(Mt("beforeSanitizeElements",e,null),At(e))return Et(e),!0;if(M(/[\\u0080-\\uFFFF]/,e.nodeName))return Et(e),!0;var o=_e(e.nodeName);if(Mt("uponSanitizeElement",e,{tagName:o,allowedTags:Ae}),e.hasChildNodes()&&!Rt(e.firstElementChild)&&(!Rt(e.content)||!Rt(e.content.firstElementChild))&&M(/<[/\\w]/g,e.innerHTML)&&M(/<[/\\w]/g,e.textContent))return Et(e),!0;if("select"===o&&M(/<template/i,e.innerHTML))return Et(e),!0;if(7===e.nodeType)return Et(e),!0;if(He&&8===e.nodeType&&M(/<[/\\w]/g,e.data))return Et(e),!0;if(!Ae[o]||je[o]){if(!je[o]&&jt(o)){if(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,o))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(o))return!1}if(Ke&&!Qe[o]){var n=k(e)||e.parentNode,i=v(e)||e.childNodes;if(i&&n)for(var a=i.length-1;a>=0;--a){var c=_(i[a],!0);c.__removalCount=(e.__removalCount||0)+1,n.insertBefore(c,b(e))}}return Et(e),!0}return e instanceof l&&!St(e)?(Et(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!M(/<\\/no(script|embed|frames)/i,e.innerHTML)?(Fe&&3===e.nodeType&&(t=e.textContent,t=x(t,be," "),t=x(t,ve," "),t=x(t,we," "),e.textContent!==t&&(S(r.removed,{element:e.cloneNode()}),e.textContent=t)),Mt("afterSanitizeElements",e,null),!1):(Et(e),!0)},kt=function(e,t,r){if(Ze&&("id"===t||"name"===t)&&(r in i||r in yt))return!1;if(De&&!Ce[t]&&M(Te,t));else if(Ne&&M(Se,t));else if(!Me[t]||Ce[t]){if(!(jt(e)&&(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&M(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,r)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(r))))return!1}else if(ot[t]);else if(M(xe,x(r,Oe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==A(r,"data:")||!tt[e])if(Ie&&!M(Ee,x(r,Oe,"")));else if(r)return!1;return!0},jt=function(e){return"annotation-xml"!==e&&P(e,Pe)},Ct=function(t){var o,n,i,a;Mt("beforeSanitizeAttributes",t,null);var c=t.attributes;if(c){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Me};for(a=c.length;a--;){var l=o=c[a],u=l.name,f=l.namespaceURI;if(n="value"===u?o.value:R(o.value),i=_e(u),s.attrName=i,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,Mt("uponSanitizeAttribute",t,s),n=s.attrValue,!s.forceKeepAttr&&(Ot(u,t),s.keepAttr))if(Ue||!M(/\\/>/i,n)){Fe&&(n=x(n,be," "),n=x(n,ve," "),n=x(n,we," "));var d=_e(t.nodeName);if(kt(d,i,n))if(!qe||"id"!==i&&"name"!==i||(Ot(u,t),n=Ye+n),He&&M(/((--!?|])>)|<\\/(style|title)/i,n))Ot(u,t);else{if(ce&&"object"===e(h)&&"function"==typeof h.getAttributeType)if(f);else switch(h.getAttributeType(d,i)){case"TrustedHTML":n=ce.createHTML(n);break;case"TrustedScriptURL":n=ce.createScriptURL(n)}try{f?t.setAttributeNS(f,u,n):t.setAttribute(u,n),At(t)?Et(t):T(r.removed)}catch(e){}}}else Ot(u,t)}Mt("afterSanitizeAttributes",t,null)}},Nt=function e(t){var r,o=xt(t);for(Mt("beforeSanitizeShadowDOM",t,null);r=o.nextNode();)Mt("uponSanitizeShadowNode",r,null),Lt(r)||(r.content instanceof a&&e(r.content),Ct(r));Mt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(n){var i,c,l,u,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((lt=!n)&&(n="\\x3c!--\\x3e"),"string"!=typeof n&&!Rt(n)){if("function"!=typeof n.toString)throw L("toString is not a function");if("string"!=typeof(n=n.toString()))throw L("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof n)return t.toStaticHTML(n);if(Rt(n))return t.toStaticHTML(n.outerHTML)}return n}if(Ge||gt(d),r.removed=[],"string"==typeof n&&(Xe=!1),Xe){if(n.nodeName){var p=_e(n.nodeName);if(!Ae[p]||je[p])throw L("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof s)1===(c=(i=Pt("\\x3c!----\\x3e")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?i=c:i.appendChild(c);else{if(!We&&!Fe&&!$e&&-1===n.indexOf("<"))return ce&&Ve?ce.createHTML(n):n;if(!(i=Pt(n)))return We?null:Ve?se:""}i&&ze&&Et(i.firstChild);for(var m=xt(Xe?n:i);l=m.nextNode();)3===l.nodeType&&l===u||Lt(l)||(l.content instanceof a&&Nt(l.content),Ct(l),u=l);if(u=null,Xe)return n;if(We){if(Be)for(f=de.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return(Me.shadowroot||Me.shadowrootmod)&&(f=me.call(o,f,!0)),f}var y=$e?i.outerHTML:i.innerHTML;return $e&&Ae["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&M(re,i.ownerDocument.doctype.name)&&(y="<!DOCTYPE "+i.ownerDocument.doctype.name+">\\n"+y),Fe&&(y=x(y,be," "),y=x(y,ve," "),y=x(y,we," ")),ce&&Ve?ce.createHTML(y):y},r.setConfig=function(e){gt(e),Ge=!0},r.clearConfig=function(){mt=null,Ge=!1},r.isValidAttribute=function(e,t,r){mt||gt({});var o=_e(e),n=_e(t);return kt(o,n,r)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],S(he[e],t))},r.removeHook=function(e){if(he[e])return T(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}return ae()}()},216:(e,t)=>{"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},87:(e,t)=>{"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let i=[];for(let e=0;e<=n.length;++e)i[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[n.length]}},448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if("true"===r)return!0;if("false"===r)return!1;return t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(87);const n={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const a=[],c=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),c)<=4&&a.push(e);return a.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${a.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},400:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(448),t),o.__exportStar(r(187),t),o.__exportStar(r(216),t),o.__exportStar(r(340),t),o.__exportStar(r(56),t),o.__exportStar(r(96),t)},187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(448)},340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(216)},56:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(216);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},96:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(448);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.domPurifyIsValidAttribute=t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.bypassPolicy=t.setRuntimeAllowedOrigins=t.urlOriginPolicy=t.emptyStringPolicyURL=t.emptyStringPolicyHTML=t.domPurifyPolicyHtml=void 0;var o=r(782);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return o.domPurifyPolicyHtml}});var n=r(908);Object.defineProperty(t,"emptyStringPolicyHTML",{enumerable:!0,get:function(){return n.emptyStringPolicyHTML}}),Object.defineProperty(t,"emptyStringPolicyURL",{enumerable:!0,get:function(){return n.emptyStringPolicyURL}});var i=r(642);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return i.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOrigins",{enumerable:!0,get:function(){return i.setRuntimeAllowedOrigins}});var a=r(460);Object.defineProperty(t,"bypassPolicy",{enumerable:!0,get:function(){return a.bypassPolicy}});var c=r(22);Object.defineProperty(t,"createTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return c.createTrustedTypesDefaultPolicy}}),Object.defineProperty(t,"createGraphicsEditorTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return c.createGraphicsEditorTrustedTypesDefaultPolicy}});var s=r(203);Object.defineProperty(t,"domPurifyIsValidAttribute",{enumerable:!0,get:function(){return s.domPurifyIsValidAttribute}});var l=r(380);Object.defineProperty(t,"uuidStringPolicyHTML",{enumerable:!0,get:function(){return l.uuidStringPolicyHTML}})},728:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o,i)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){i?.(`${e}`)}return r[e]}},460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const o=r(728);t.createBypassPolicy=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},22:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const o=r(400),n=r(728),i=r(203),a=r(642);t.createDefaultPolicyInternal=(e,t)=>{(0,n.createPolicy)("default",{createHTML:(e,r,o)=>{try{if("Element innerHTML"===o&&ee(C,h))return te.has(e)?e:(0,i.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===o&&ee(I,g)||"Element setAttribute"===o&&ee(q,T))return e}catch(e){t?.(`${e}`)}},createScript:(e,r,n)=>{try{if("eval"===n&&ee(F,b))return e;if("HTMLScriptElement text"===n&&ee(K,w)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,o.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===n&&ee(void 0,S))return e}catch(e){t?.(`${e}`)}},createScriptURL:(e,r,o)=>{try{if("Worker constructor"===o&&ee(X,_)||"HTMLScriptElement src"===o&&ee(Z,v)){const{origin:t}=new URL(e,document.baseURI);if((0,a.isAnAllowedOrigin)(t))return e}}catch(e){t?.(`${e}`)}}},e,t)};t.createTrustedTypesDefaultPolicy=e=>(0,t.createDefaultPolicyInternal)(void 0,e);t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(A,h))return(0,i.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const c=/https?:\\/\\/[^\\s/$.?#].[^\\s]*/g,s=/\\/officeonline\\/versioned\\/mathjax\\-lowercase\\-patched\\/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/mathjax\\/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/(config\\/|jax\\/output\\/html\\-css\\/)?/,l=/\\/(officeonline\\/)?o\\/s\\/h?([0-9a-fA-F])+_app_scripts\\/(wp5\\/)?/,u=/\\/(officeonline\\/)?x\\/s\\/h?([0-9a-fA-F])+__layouts\\/app_scripts\\/((wp5|ac|cc|es6|rslc\\d+|)\\/)?/,f=/\\/1js\\/(build|pr)\\/[0-9a-fA-F]+/,d=/\\/wd1js\\/(ship|debug)\\/(we|wv|x)\\/(_layouts\\/)?app_scripts\\/((wp5|ac|cc|es6|rslc\\d+)\\/)?/,p=/\\/wo\\/webpack\\/((wp5|ac|cc|es6|rslc\\d+)\\/)?/,m=/\\/officeonline\\/pods\\/s\\/(h[0-9a-fA-F]+|\\d+)_(app_scripts|pptscripts)\\/?/,y=new RegExp(`(${/\\/officeonline\\/hashed\\/[0-9a-fA-F]+\\//.source}|${l.source}|${u.source}|${f.source}(${d.source}|${p.source}|/lib-es5/)|${m.source})`),h=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\\-]){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\\.debug)?\\.(core\\.common|core1|core2|core3|precore)|(\\@1js\\/oscui\\-compact\\-quill\\@\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/[A-Za-z0-9-]+\\/v\\d{1,10}\\/bundled\\/dist\\/quill\\.custom))\\.(min\\.)?js/,g=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\\.debug)?\\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\\.min)?\\.js(\\:|$)/,_=/(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\\.min)?\\.js/,b=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\\.debug)?\\.core3)\\.(min\\.)?js/,v=/(dime|wacboot|officewebsurfaces\\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\\.debug)?\\.(core1|core2|core3|precore))(\\.min)?\\.js/,w=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?)(\\.min)?\\.js/,T=/(common|copilotcommonux)\\.(min\\.)?js/,S=/(officebrowserfeedback_floodgate)\\.(min\\.)?js/,E=new RegExp(`(${y.source})(common|common50|commonux([0-9a-fA-F]|\\\\-){0,10}|jquery(\\\\.signalr\\\\.merge\\\\.\\\\d+\\\\.\\\\d+\\\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\\\.(min\\\\.)?js`),O=new RegExp(`${s.source}(mathjax|jax|mml_htmlormml)\\\\.js`),P=new RegExp(`${l.source}mathjax/(mathjax)\\\\.js`),x=new RegExp("/scripts/me/mecontrol/\\\\d{1,10}\\\\.\\\\d{1,10}\\\\.\\\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),A=new RegExp(`(/officeonline/versioned/host-word/\\\\d{1,4}\\\\.\\\\d{1,2}\\\\.\\\\d{1,2}/|${m.source}|${f.source}(${d.source}|${p.source}|/lib-es5/))(gc2|gc2host)\\\\.(min\\\\.)?js`),R=new RegExp(`(${u.source}|${f.source}(${d.source}|${p.source}|/lib-es5/))(gc2host)\\\\.(min\\\\.)?js`),M=new RegExp(`(${m.source})(pptedit(ds)?\\\\.precore)\\\\.(min\\\\.)?js`),L=new RegExp(`(${m.source})(pptedit(ds)?\\\\.core\\\\.common)\\\\.(min\\\\.)?js`),k=new RegExp(`(${m.source})(immersivereader)\\\\.(min\\\\.)?js`),j=new RegExp(`(${m.source})(pptedit(ds)?\\\\.(core1|core2|core3))\\\\.(min\\\\.)?js`),C=new RegExp(`(${E.source})|(${O.source})|(${P.source})|(${x.source})|(${A.source})|(${R.source})|(${M.source})|(${L.source})|(${k.source})|(${j.source})`),N=new RegExp(`(${y.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\\\.(min\\\\.)?js(\\\\:|$)`),D=new RegExp(`${s.source}mml_htmlormml.js`),I=new RegExp(`(${N.source})|(${D.source})`),U=new RegExp(`(${u.source}|${f.source}(${d.source}|${p.source}))feedback/officebrowserfeedback_floodgate\\\\.(min\\\\.)?js`),F=new RegExp(`((${y.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\\\.(min\\\\.)?js)|(${U.source})`),H=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\\\.core\\\\.(min\\\\.)?js"),$=new RegExp(`(${y.source}(lpplazy|midgardbootstrapper)|(${s.source}mathjax))\\\\.(min\\\\.)?js`),G=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\\\.(min\\\\.)?js"),z=new RegExp("/dime/v1/dime\\\\.js"),W=new RegExp(`(${y.source}(mathjax/mathjax\\\\.js))`),B=new RegExp(`(${y.source}(pptedit(?:ds)?\\\\.(precore|core1|core2|core3)\\\\.js))`),V=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\\\.js"),Z=new RegExp(`${H.source}|${$.source}|${G.source}|${z.source}|${W.source}|${B.source}|${V.source}`),q=new RegExp(`(${y.source})(common|copilotcommonux)\\\\.(min\\\\.)?js`),Y=new RegExp(`${s.source}mathjax.js`),K=new RegExp(`((${y.source})wordeditords(eagercompile|separatedialog)?(\\\\.box4\\\\.dll1)?\\\\.js)|(${Y.source})`),X=new RegExp(`(${y.source})(wordeditords(eagercompile|separatedialog|\\\\.debug)?\\\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\\\.(min\\\\.)?js`),J=e=>"https://amcdn.msftauth.net"===e||(0,a.isAnAllowedOrigin)(e),Q=e=>a.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const o=r.stack.match(c);if(!o?.length)return!1;for(const r of o)try{const{origin:o,pathname:n}=new URL(r);if(!J(o))continue;const i=n.toLowerCase(),a=Q(o)&&t?.test(i),c=e?.test(i);if(c||a)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href=\'#\'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href=\'\' disabled=\'disabled\'></a><select disabled=\'disabled\'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},650:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\\"alert(\'XSS\')\\"></div>",maliciousSVG:\'<svg><circle cx="50" cy="50" r="40" onclick="alert(\\\'XSS\\\')"></circle></svg>\',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\\"alert(\'XSS\')\\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:\'<svg><circle r="40" cy="50" cx="50"></circle></svg>\',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:[\'<div paraid="example"></div>\',\'<div lang="en"></div>\'],missingTagsHTML:[\'<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>\',"\\x3c!-- This is a comment --\\x3e<div>Content</div>"]}},782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const o=r(728),n=r(203);t.createDomPurifyPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:(e,t,r)=>(0,n.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},203:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const o=r(533),n=r(399),i=o.__importStar(r(650));t.sanitizedHTMLAndValidate=(e,t,r)=>{let o=!1;const a=t?(e=>({...i.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):i.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,n.addHook)(e,t)}));const c=(0,n.sanitize)(e,a);return r&&Object.entries(r).forEach((([e])=>{(0,n.removeHooks)(e)})),t?.USE_PROFILES?c:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=i.htmlBlockListAttributes.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=i.htmlBlockList.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(n.removed),o?e:c)},t.domPurifyIsValidAttribute=n.isValidAttribute},908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const o=r(728);t.createEmptyStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML");t.createEmptyStringPolicyURL=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},642:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.bbRunsRegex=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const o=r(728),n=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let i=[];t.setRuntimeAllowedOrigins=e=>{i=i.concat(e)};const a=[/^https?:\\/\\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel|visio)\\.officeapps\\.live\\.com$/],c=[/^https?:\\/\\/([\\w-]+-)?(excel)(-[\\w-]+)?\\.cdn\\.office\\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\\\.teams\\\\.(office|live)\\\\.com|cpc-[\\\\w-]+|[\\\\w-]+\\\\.[\\\\w-]+\\\\.corp\\\\.microsoft\\\\.com)(:\\\\d+)?)(:|/|$)"),t.bbRunsRegex=new RegExp("^https?://[\\\\w-]+\\\\.pyxidis\\\\.off(:\\\\d+)?$");t.isAnAllowedOrigin=e=>n.includes(e)||i.includes(e)||a.some((t=>t.test(e)))||c.some((t=>t.test(e)))||t.localhostRegex.test(e)||t.bbRunsRegex.test(e);t.createUrlOriginPolicy=(e,r)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const o=r(728);t.createUUIDStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=c,t.setConfig=function(e){if(s)throw new TypeError("setConfig has already been called");s=e},t.getSafeParams=function(){const e=s??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??s?.createTimeout??n},t.getCreateMode=function(e){const t=e?.createMode??s?.createMode??i;return"ThreadOrLocal"===t?c()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(s?.onWorkerError??f)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(s?.onCreateWorker??d)(e)}catch(e){l(e)}};const o=r(739),n=3e5,i="Thread";var a;function c(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let s;function l(e){setTimeout((()=>{throw e}))}function u(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function f(e){const t=u();if(void 0!==t){const r={kind:a.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function d(e){const t=u();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={}))},739:(e,t)=>{"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function n(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?n(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=n,t.encodeError=i,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0===t){const t=(0,o.getTrustedScriptUrls)([...e]);return void importScripts(...t)}for(const r of e)i(r,t)};const o=r(481);function n(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const n=e.slice(0,o+1),i=e.slice(o+1).split("&");let a=0;for(;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]=`${t}=${r}`,n+i.join("&")}function i(e,t){let r;for(let i=0;i<=t;i+=1)try{const t=i>0?n(e,"retries",String(i)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},619:(e,t)=>{"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:n()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:n,createOutside:i,createThread:c}=e,{status:l,start:u,end:f}=o;if("Pending"===l||void 0===f)return;return{id:t,createMode:r,createWorker:{status:l,absStart:u,duration:a(f-u)},createThread:"Thread"===r?s(c,u,f):void 0,createOutside:s(i,u,f),insideInit:s(n,u,f)}};const o=r(739),n="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??n()))}function a(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const o=c(e?.start??1/0,t,r),n=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:a(o-t),end:a(n-t),duration:a(n-o)}}},481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){n=e??!1,i=n?o.urlOriginPolicy:void 0},t.getTrustedUrl=a,t.getTrustedScriptUrls=function(e){if(!n||!i)return e;return e.map(a)};const o=r(268);let n,i;function a(e){if(n&&i)try{return i.createScriptURL(e)}catch{return e}return e}},533:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>C,__assign:()=>i,__asyncDelegator:()=>O,__asyncGenerator:()=>E,__asyncValues:()=>P,__await:()=>S,__awaiter:()=>m,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>j,__classPrivateFieldSet:()=>k,__createBinding:()=>h,__decorate:()=>c,__disposeResources:()=>D,__esDecorate:()=>l,__exportStar:()=>g,__extends:()=>n,__generator:()=>y,__importDefault:()=>M,__importStar:()=>R,__makeTemplateObject:()=>x,__metadata:()=>p,__param:()=>s,__propKey:()=>f,__read:()=>b,__rest:()=>a,__runInitializers:()=>u,__setFunctionName:()=>d,__spread:()=>v,__spreadArray:()=>T,__spreadArrays:()=>w,__values:()=>_,default:()=>I});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function c(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function s(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=o.kind,l="getter"===s?"get":"setter"===s?"set":"value",u=!t&&e?o.static?e:e.prototype:null,f=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),d=!1,p=r.length-1;p>=0;p--){var m={};for(var y in o)m[y]="access"===y?{}:o[y];for(var y in o.access)m.access[y]=o.access[y];m.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var h=(0,r[p])("accessor"===s?{get:f.get,set:f.set}:f[l],m);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=a(h.get))&&(f.get=c),(c=a(h.set))&&(f.set=c),(c=a(h.init))&&n.unshift(c)}else(c=a(h))&&("field"===s?n.unshift(c):f[l]=c)}u&&Object.defineProperty(u,o.name,f),d=!0}function u(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function f(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((o=o.apply(e,t||[])).next())}))}function y(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,n++)o[n]=i[a];return o}function T(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){i.push([e,t,r,o])>1||c(e,t)}))})}function c(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,l):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function s(e){c("next",e)}function l(e){c("throw",e)}function u(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}}function O(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:S(e[o](t)),done:!1}:n?n(t):t}:n}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){(function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)})(o,n,(t=e[r](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return A(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function k(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function j(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function C(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function D(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const I={__extends:n,__assign:i,__rest:a,__decorate:c,__param:s,__metadata:p,__awaiter:m,__generator:y,__createBinding:h,__exportStar:g,__values:_,__read:b,__spread:v,__spreadArrays:w,__spreadArray:T,__await:S,__asyncGenerator:E,__asyncDelegator:O,__asyncValues:P,__makeTemplateObject:x,__importStar:R,__importDefault:M,__classPrivateFieldGet:L,__classPrivateFieldSet:k,__classPrivateFieldIn:j,__addDisposableResource:C,__disposeResources:D}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(400),n=r(691),i=r(739),a=r(762),c=r(619),s=r(506),l=r(481);self.onmessage=({data:{config:e,port:r,options:o,script:u,args:f,featureGateDictionary:d,changeGateDictionary:p}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,l.setUpTrustedTypesConfig)(o.isTrustedTypesPolicyEnabled),(0,t.setFeatureGateDictionaryGetter)((()=>d)),(0,t.setChangeGateDictionaryGetter)((()=>p));const m=o.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let y;function h(){if(y)return y;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,a.importScriptsWithRetry)([e.typedWorkersUrl],m),y=(0,c.indexObject)(self,e.typedWorkersName??"typedWorkers"),y.setConfig(e),y}const g=(0,s.startStopwatch)();function _(e,t){const r=e?void 0:(0,i.encodeResultValue)((0,i.asError)(t)),o={kind:n.ThreadMessageKind.InitResult,error:r,stopwatch:g};self.postMessage(o),e||setTimeout(self.close.bind(self),6e4)}try{(0,s.timePromise)(g,(()=>{(0,a.importScriptsWithRetry)([...o?.importScriptUrls??e.importScriptUrls??[],...void 0!==u.scriptUrl?[u.scriptUrl]:[]],m);return(0,c.indexObject)(self,u.insideInitName)({config:e,importTypedWorkers:h,connection:{port:r,options:o,createMode:"Thread"}},...f)})).then((()=>_(!0)),(e=>_(!1,e)))}catch(e){_(!1,e)}}})(),threadBootstrap=o})();})()'},733:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){n=e??!1,a=n?o.urlOriginPolicy:void 0},t.getTrustedUrl=i,t.getTrustedScriptUrls=function(e){return n&&a?e.map(i):e};const o=r(996);let n,a;function i(e){if(n&&a)try{return a.createScriptURL(e)}catch{return e}return e}},489:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownErrorClasses=t.WorkerError=void 0,t.getErrorEventWorkerError=function(e,t,r){if((0,o.isError)(r.error)){if((0,o.isWorkerError)(r.error))return r.error;const a={cause:"UnhandledError",idInfo:e,error:r.error};return new n(`${t} received an unhandled error`,a)}if(null==r.message)return new n(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const a={cause:"UnhandledError",idInfo:e},i=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new n(`${t} received an unhandled error: ${i}`,a)},t.decodeError=a,t.decodeWorkerErrorInfo=i,t.decodeResultValue=function(e){return e.isError?a(e.value):e.value};const o=r(471);class n extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function a(e){let r;if("WorkerError"===e.name)r=new n(e.message,i(e.info));else{const o=t.knownErrorClasses[e.name];o?r=new o(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function i(e){return{...e,error:e.error?a(e.error):void 0}}t.WorkerError=n,n.isWorkerError=o.isWorkerError,t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError}},158:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return"undefined"==typeof self?void 0:self.name}},533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return W},__assign:function(){return a},__asyncDelegator:function(){return T},__asyncGenerator:function(){return v},__asyncValues:function(){return P},__await:function(){return E},__awaiter:function(){return m},__classPrivateFieldGet:function(){return k},__classPrivateFieldIn:function(){return L},__classPrivateFieldSet:function(){return O},__createBinding:function(){return h},__decorate:function(){return s},__disposeResources:function(){return F},__esDecorate:function(){return l},__exportStar:function(){return y},__extends:function(){return n},__generator:function(){return g},__importDefault:function(){return x},__importStar:function(){return M},__makeTemplateObject:function(){return A},__metadata:function(){return f},__param:function(){return c},__propKey:function(){return d},__read:function(){return S},__rest:function(){return i},__runInitializers:function(){return u},__setFunctionName:function(){return p},__spread:function(){return _},__spreadArray:function(){return w},__spreadArrays:function(){return C},__values:function(){return b},default:function(){return D}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),p=!1,f=r.length-1;f>=0;f--){var m={};for(var g in o)m[g]="access"===g?{}:o[g];for(var g in o.access)m.access[g]=o.access[g];m.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[f])("accessor"===c?{get:d.get,set:d.set}:d[l],m);if("accessor"===c){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=i(h.get))&&(d.get=s),(s=i(h.set))&&(d.set=s),(s=i(h.init))&&n.unshift(s)}else(s=i(h))&&("field"===c?n.unshift(s):d[l]=s)}u&&Object.defineProperty(u,o.name,d),p=!0}function u(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}function g(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var h=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function w(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof E?Promise.resolve(r.value.v).then(c,l):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function T(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:E(e[o](t)),done:!1}:n?n(t):t}:n}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return I(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function O(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function L(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function W(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function F(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const D={__extends:n,__assign:a,__rest:i,__decorate:s,__param:c,__metadata:f,__awaiter:m,__generator:g,__createBinding:h,__exportStar:y,__values:b,__read:S,__spread:_,__spreadArrays:C,__spreadArray:w,__await:E,__asyncGenerator:v,__asyncDelegator:T,__asyncValues:P,__makeTemplateObject:A,__importStar:M,__importDefault:x,__classPrivateFieldGet:k,__classPrivateFieldSet:O,__classPrivateFieldIn:L,__addDisposableResource:W,__disposeResources:F}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{BaseError:function(){return T},CCPError:function(){return F},CancelError:function(){return $},CancelErrorTypes:function(){return _},ClipboardPlatformError:function(){return N},ClipboardPlatformErrorTypes:function(){return y},ClipboardStorageType:function(){return je},ClipboardStrategyBase:function(){return Wt},ClipboardStrategyType:function(){return h},CopyClipboardCommand:function(){return ne},CopyClipboardEvent:function(){return se},CopyContext:function(){return fr},CopyError:function(){return D},CopyErrorTypes:function(){return b},CopyStatus:function(){return gr},CutClipboardCommand:function(){return ae},CutClipboardEvent:function(){return ce},CutCopyPasteFlags:function(){return $e},InfraInitializationErrorTypes:function(){return Ne},InvalidArgumentError:function(){return I},InvalidOperationError:function(){return M},LocalStorageChangedEventFlagPostfix:function(){return cr},LocalStorageClipboardStorage:function(){return Sr},LocalStorageClipboardStrategy:function(){return Cr},LocalStorageKeyChangeTracker:function(){return wr},MessageDestinationConst:function(){return It},MismatchVersionError:function(){return k},MissingArgumentError:function(){return A},NoUserHash:function(){return Ct},NoValidKeyError:function(){return P},PasteClipboardCommand:function(){return ie},PasteClipboardEvent:function(){return le},PasteContext:function(){return mr},PasteError:function(){return j},PasteErrorTypes:function(){return S},SharedClipboardError:function(){return U},TTLClipboardDataError:function(){return O},UnexpectedError:function(){return W},UnsupportedError:function(){return x},UserHashMismatchError:function(){return L},WindowRPCBase:function(){return qt},addEventListener:function(){return ue},cloneMetadata:function(){return yr},createClipboardItems:function(){return xe},createClipboardOperationMessage:function(){return At},createClipboardOperationResultMessage:function(){return kt},createContextId:function(){return vt},createCopyPasteInfra:function(){return co},createDeferredPromise:function(){return Ft},createDeferredPromiseCache:function(){return Ut},createDisposableImplementationExtension:function(){return Lt},createLocalStorageClipboardStorage:function(){return br},createLocalStorageClipboardStrategy:function(){return _r},createMessageDeserializer:function(){return zt},createMessageId:function(){return Et},createMessageSerializer:function(){return Jt},createWindowRPCClientReceiver:function(){return Qt},createWindowRPCClientSender:function(){return or},createWindowRPCServerReceiver:function(){return Yt},createWindowRPCServerSender:function(){return rr},defaultClipboardDataFormat:function(){return de},defaultIEClipboardDataFormat:function(){return pe},emptyString:function(){return d},getCanonicalValidatedMessageId:function(){return Tt},getClipboardItem:function(){return We},getClipboardItemContent:function(){return ke},getClipboardItemsCount:function(){return Me},getClipboardItemsDataCount:function(){return Ie},getDefaultClipboardData:function(){return Re},getDeferredClipboardItemContent:function(){return Oe},getEmptyClipboardItemsData:function(){return Te},getEmptyMetadata:function(){return hr},getImmutableEmptyClipboardItems:function(){return Ae},getItemsFromClipboardItems:function(){return Fe},getLocalStorageDataKey:function(){return ur},getLocalStorageMetadataKey:function(){return dr},getLocalStorageMetadataKeyToWatch:function(){return pr},getSharedClipboardValidatedOrigin:function(){return mt},getStringifiedError:function(){return uo.getStringifiedError},getValidatedRemoteWindow:function(){return Kt},getWindowLocation:function(){return rt},getWindowMessaging:function(){return re},htmlClipboardItem:function(){return t},imageClipboardDataFormat:function(){return me},init:function(){return V},initLogger:function(){return u},initMessageIdPrefix:function(){return Gt},initializeHtmlMinifierWorker:function(){return _o},isChromiumEdge:function(){return te},isClipboardPlatformErrorType:function(){return C},isClipboardPlatformErrorTypes:function(){return w},isEdge:function(){return Y},isEdgeVersionWithTextHtmlWrapperSupport:function(){return ee},isEdgeWithTextHtmlClipboardSupport:function(){return Q},isIE:function(){return X},isLocalStorageInaccessible:function(){return E},isLocalStorageSupported:function(){return lr},isValidClipboardOperationCode:function(){return Mt},metadataAdditionalSignatureDataAttributes:function(){return we},metadataChromeExtensionId:function(){return Se},metadataCopyContextClipboardDataFormat:function(){return Ee},metadataCopyContextWebCustomDataFormat:function(){return ve},metadataCopyId:function(){return Ce},metadataInfraVersionFormat:function(){return _e},metadataIsLastCopyWasExternal:function(){return ye},metadataIsLastCopyWasExternalXLOSource:function(){return be},metadataLastCopyWasExternal:function(){return m},metadataLastCopyWasExternalXLOSource:function(){return g},oneDot:function(){return f},oneSpace:function(){return p},queryStringBulsEndpointUrlParameter:function(){return Ue},queryStringCreatorOriginParameter:function(){return Bt},queryStringSessionIdParameter:function(){return ze},queryStringWacClusterParameter:function(){return He},rethrowAfterAllActions:function(){return H},setCopyPasteInfraFeatureGateManager:function(){return Co},shadowWorkbookClipboardDataFormat:function(){return ge},shadowWorkbookClipboardWebCustomDataFormat:function(){return he},sharedClipboardSettings:function(){return e},shouldClearClipboard:function(){return wt},textHtmlClipboardDataFormat:function(){return fe},ulsLogger:function(){return l},unknownMessageId:function(){return Vt},validateClipboardOperationMessage:function(){return xt},validateClipboardOperationResultMessage:function(){return Ot},validateRemoteWindowOrigin:function(){return gt}});var e={};r.r(e),r.d(e,{createEmptySharedClipboardSettings:function(){return tt},defaultPromiseTimeoutInMinutes:function(){return Ke},getSharedClipboardSettings:function(){return Xe},initializeSharedClipboardSettings:function(){return Qe},initializeSharedClipboardSettingsFromWindow:function(){return Ye},sharedClipboardSettingsVariableName:function(){return Ge}});var t={};let n;r.r(t),r.d(t,{addClipboardWrapperForEdge:function(){return ro},ccpTimestampHtmlCustomAttributeName:function(){return Br},createHtmlItemFromTextPlain:function(){return Yr},createPlainTextFromHtml:function(){return Qr},createTextHtmlFromTextPlain:function(){return Xr},divTagName:function(){return Wr},encodeAngleBrackets:function(){return io},ensureOneLFPerNewLine:function(){return qr},getCcpTimestampHtmlCustomAttributeFromWrappingTag:function(){return no},getExternalSource:function(){return ao},getFragmentFromTextHtml:function(){return oo},isContainsTimestampWrapper:function(){return to},minCcpTimestampHtmlCustomAttributeValue:function(){return Kr},preTagName:function(){return Rr},tableTagName:function(){return Fr},tdTagName:function(){return jr},trTagName:function(){return Dr},trimToLength:function(){return Zr},wrapContentWithTagAndAttributes:function(){return so}});const a=e=>{n=e};class i{static setFeatureGateManager(e){a(e)}}var s=r(234);let c;function l(){return c}function u(e){if(!e)throw new Error("The 'logger' argument is missing");c=s.Hv.getFromExternalLogger(e)}const d="",p=" ",f=".",m="1",g="1";var h,y,b,S,_;function C(e,t){return w(e,[t])}function w(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function E(e){if(e&&"object"==typeof e){if(v(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(v(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(v(JSON.parse(e).reason))return!0}catch{}return!1}function v(e){return e===y.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(h||(h={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(y||(y={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(b||(b={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(S||(S={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(_||(_={}));class T extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():d}constructor(e,t,r){const o=T.augmentParameterValue(e);if(super(o),this.name=T.augmentParameterValue(t),this.errorName=this.name,this.name?l().ULS.traceTag(596456211,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Error '${this.name}': ${o}`):l().ULS.traceTag(596456212,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=T.augmentParameterValue(e);t.length>0&&l().ULS.traceTag(596456213,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class P extends T{constructor(e,t){super(e,"NoValidKeyError",t)}}class A extends T{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=T.augmentParameterValue(t),n=A.getDefaultMessage(o);let a=T.augmentParameterValue(e);0===a.length&&(a=n),super(a,"MissingArgumentError",r),this.name=o}}class I extends T{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const n=T.augmentParameterValue(t);let a=r;a||(a=d);const i=I.getDefaultMessage(n,a);let s=T.augmentParameterValue(e);0===e.length&&(s=i),super(s,"InvalidArgumentError",o),this.name=n,this.value=a}}class M extends T{constructor(e,t){super(e,"InvalidOperationError",t)}}class x extends T{constructor(e,t){super(e,"UnsupportedError",t)}}class k extends T{constructor(e,t,r,o,n){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",n)}}class O extends T{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class L extends T{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class W extends T{constructor(e,t){super(e,"UnexpectedError",t)}}function R(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:d}class F extends T{constructor(e,t,r,o,n){super(t||`reason=${e}`,r,o),this.reason=e,n&&(this.errorName=n)}}class D extends F{constructor(e,t,r){super(e,t,"CopyError",r,R(e,b))}}class j extends F{constructor(e,t,r){super(e,t,"PasteError",r,R(e,S))}}class $ extends F{constructor(e,t,r){super(e,t,"CancelError",r,R(e,_))}}class N extends F{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,R(e,y))}}class U extends F{constructor(e,t,r){super(e,t,"SharedClipboardError",r,R(e,y))}}function H(e){if(!e||!Array.isArray(e)||0===e.length)return void l().ULS.traceTag(596456214,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){l().ULS.traceTag(596456216,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new M(e.message,e))}else l().ULS.traceTag(596456215,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function z(){return J}const J={userAgent:()=>window&&window.navigator?window.navigator.userAgent:d,appVersion:()=>window&&window.navigator?window.navigator.appVersion:d};let G={};function V(){G={}}const B=new RegExp("(\\bTrident/| MSIE )"),K=16.16299,q=17.17123,Z=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function X(){if(void 0===G.isIEProperty){G.isIEProperty=!1;const e=z();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(B);e&&2===e.length&&(G.isIEProperty=!0)}}}return G.isIEProperty}function Y(){if(void 0===G.isEdgeProperty){G.isEdgeProperty=!1,G.isEdgeWithTextHtmlClipboardSupportProperty=!1,G.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=z();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(Z);if(e&&2===e.length){G.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=K&&(G.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=q&&(G.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return G.isEdgeProperty}function Q(){return Y()&&G.isEdgeWithTextHtmlClipboardSupportProperty}function ee(){return Y()&&G.isEdgeVersionWithTextHtmlWrapperSupportProperty}function te(){const e=z();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function re(){return oe}const oe={postMessage:(e,t,r,o)=>{e.postMessage(t,r,o)}},ne="copy",ae="cut",ie="paste",se="copy",ce="cut",le="paste",ue=(e,t,r,o)=>{const n=o||!1;return e.addEventListener(t,r,n),()=>{e.removeEventListener(t,r,n)}},de="text/plain",pe="Text",fe="text/html",me="image/png",ge="data/shadow-workbook",he="web data/shadow-workbook",ye="metadata/is-last-copy-was-external",be="metadata/is-last-copy-was-external-XLO-source",Se="metadata/chrome-extension-id",_e="metadata/ccp-infra-version",Ce="copyId",we="metadata/additional-signature-data-attributes",Ee="metadata/copy-context",ve="web metadata/copy-context";function Te(){return{items:{}}}const Pe=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new M(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":d}empty)`)},setDeferredItem:(e,t)=>{throw new M(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>De(void 0)}}();function Ae(){return Pe}function Ie(e){return e&&e.items?Object.keys(e.items).length:0}function Me(e){return Ie(e&&e.getData())}function xe(e=void 0){let t=e;return t||(t={items:{}}),{getItem:e=>ke(t,e),setItem:(e,r)=>{Le(t,e,r)},setDeferredItem:(e,r)=>{Le(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>Oe(t,e),getData:()=>t,get:()=>De(t)}}function ke(e,t){if(!e)throw new A(d,"clipboardItemsData");if(!e.items)throw new I(d,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function Oe(e,t){if(!e)throw new A(d,"clipboardItemsData");if(!e.items)throw new I(d,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:de}))}function Le(e,t,r){if(!e)throw new A(d,"clipboardItemsData");if(!e.items)throw new I(d,"clipboardItemsData.items");e.items[t]=r}function We(e,t){if(!e||0===e.length||!t||!t.trim())return d;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||d}function Re(e){return We(e,de)}function Fe(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:de,data:d}),t}function De(e){const t=[];if(0===Ie(e))return t;for(const r in e.items){let o=e.items[r];o||(o=d);const n={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(n)}return t}var je,$e,Ne;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(je||(je={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}($e||($e={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Ne||(Ne={}));const Ue="BulsEndpointUrl",He="WacCluster",ze="usid",Je="-",Ge="sharedClipboardSettings",Ve=1,Be=3600,Ke=2;let qe=tt(),Ze=!1;function Xe(){if(!Ze)throw new M("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return qe}function Ye(){Ze=!1,function(){if(!window||!(Ge in window))return qe=tt(),void(Ze=!0);const e=window[Ge];if(!e||"object"!=typeof e)return qe=tt(),void(Ze=!0);et(e)}()}function Qe(e){Ze=!1,et(e)}function et(e){if(!e)throw new A(d,"sharedClipboardSettingsCandidate");const t=tt();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return qe=t,void(Ze=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return l().ULS.traceTag(596124181,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),qe=t,void(Ze=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(Je);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{l().ULS.traceTag(579737680,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return l().ULS.traceTag(596124182,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],qe=t,void(Ze=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{l().ULS.traceTag(579737681,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return l().ULS.traceTag(596124183,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return l().ULS.traceTag(596124184,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return l().ULS.traceTag(596124185,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0)}t.whitelistOriginComponents=!0,qe=t,Ze=!0}function tt(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:d,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Ve,sharedClipboardExpirationInMinutes:Be,clipboardPromiseTimeoutInMinutes:Ke,remoteLoggerPath:d}}function rt(){let e=d;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=d)):(l().ULS.traceTag(595932950,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const ot="://",nt="http",at="https",it=".",st="/",ct=":",lt=new RegExp("^\\d+$");let ut,dt,pt=!1;function ft(e){if(!e)throw new A(d,"origin");const t=e.trim().toLowerCase();let r=d,o=t.split(ot,3);if(!o||0===o.length||!o[0]||o[0]!==nt&&o[0]!==at)throw new I("Missing protocol","origin",e);if(1===o.length)throw new I("Missing domain","origin",e);if(o.length>2)throw new I(`'${ot}' should appear once`,"origin",e);let n=o[1];if(!n)throw new I("Missing domain","origin",e);if(r=o[0]+ot,n=n.trim(),o=n.trim().split(st,3),!o||0===o.length||!o[0]||!o[0].trim())throw new I("Missing domain","origin",e);if(o.length>2)throw new I("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new I("The last part of the origin should be the domain","origin",e);if(o=n.split(ct,3),!o||0===o.length||!o[0]||!o[0].trim())throw new I("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new I("The last part of the origin should be the domain and an optional port number","origin",e);if(n=o[0].trim(),r+=n,2===o.length){const t=o[1].trim(),n=lt.exec(t);if(!n||1!==n.length)throw new I("Invalid port number","origin",e);const a=Number(t);if(isNaN(a))throw new I("Invalid port number","origin",e);r+=ct+t}return l().ULS.traceTag(596452423,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function mt(e){St();const t=ft(e);let r=t.split(ot);if(!r||2!==r.length||!r[0]||!r[1])throw new I("Invalid origin","parentOrigin",e);const o=Xe();let n=d;if(o.whitelistOriginComponents){const t=r[0]+ot;if(r=r[1].split(it),!r||r.length<2||!r[0])throw new I("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=t+r.join(it)}else n=t;return l().ULS.traceTag(596452424,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${n}' components=${JSON.stringify(r)}`),n}function gt(e){St();const t=ft(e),r=ft(rt().origin);if(t===r)return t;if(!Xe().whitelistOriginComponents)throw new M(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=ht(t),n=ht(r);if(o.protocol!==n.protocol)throw new M(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(o.environment!==n.environment)throw new M(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function ht(e){St();const t=e.split(ot,2),r=t[0],o=yt(t[1]),n={protocol:r};if(n.environment=bt(e,o,dt),o.length<=n.environment.length+1)throw new I("Missing app component","origin",e);if(o.charAt(n.environment.length)!==it)throw new I("Missing a domain separator after the environment component","origin",e);const a=o.substr(n.environment.length+it.length);if(n.app=bt(e,a,ut),n.app.length<a.length&&a.charAt(n.app.length)!==Je)throw new I(`When the Office Online app name is not the domain prefix, '${Je}' should precede it`,"origin",e);return n}function yt(e){if(!e)throw new A(d,"stringToReverse");const t=e.length;let r=d;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function bt(e,t,r){if(!t)throw new A(d,"reversedValidatedHostname");if(!r)throw new A(d,"reversedStringsToLengthMap");const o=t.length,n=Object.keys(r).filter((e=>{const n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return yt(n[0]);throw new I("Invalid origin","validatedOrigin",e)}function St(){if(pt)return;const e=Xe();e.whitelistOriginComponents&&(ut=_t(e.sharedClipboardHostingApps),dt=_t(e.sharedClipboardHostingEnvironments),pt=!0)}function _t(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[yt(e)]=e.length})),t):t}const Ct=1;function wt(e,t){return null==e||e===Ct||null==t||e!==t}function Et(){return Pt()}function vt(){return Pt()}function Tt(e){if(!e)throw new A(d,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new I(d,"id");return t}function Pt(){return(Math.random()+1).toString(36).substring(7)}function At(e,t,r,o,n){const a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return xt(a),a}class It{}function Mt(e){return"get"===e||"set"===e||"init"===e}It.localStorageData="localStorage/data",It.localStorageMetadata="localStorage/metadata",It.initIframe="initIframe";const xt=function(e){if(!e)throw new A(d,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new A(d,"id");if(!e.operationCode)throw new A(d,"operationCode");if(!e.destination)throw new A(d,"destination");if(!Mt(e.operationCode))throw new I(d,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new I(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function kt(e,t,r,o,n){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return Ot(a),a}const Ot=function(e){if(!e)throw new A(d,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new P("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw l().ULS.traceTag(553747865,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new A(d,"id");if(!e.operationCode)throw new A(d,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new I(d,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new I(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new I(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new I(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new I(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new I(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new I(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function Lt(e){if(!e||0===e.trim().length)throw new I(d,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&l().ULS.traceTag(596456217,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new M(r(e))}}})()}class Wt{initialize(e){return e.then((e=>(this.clipboardStorage=e,l().ULS.traceTag(596453007,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(l().ULS.traceTag(596453008,s.nh.msoulscat_ES_EWAJS,E(e)?s.kp.Info:s.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${s.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return l().ULS.shipAssertTag(596121485,s.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new N(y.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new N(y.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return l().ULS.shipAssertTag(596121486,s.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new N(y.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw l().ULS.traceTag(507848131,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${s.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new N(y.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(Ae(),e):(l().ULS.shipAssertTag(595882508,s.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new N(y.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new N(y.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Lt(`${e}`)}}const Rt=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Ft(e){let t=e;return t&&0!==t.trim().length||(t=Et()),new Nt(t)}function Dt(){return Rt?window.performance.now():Date.now()}function jt(e){return Rt?new Date(e+window.performance.timing.navigationStart):new Date(e)}function $t(e,t,r){if(!r)throw new A(d,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Dt()-r}ms`}class Nt{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):l().ULS.traceTag(596456257,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):l().ULS.traceTag(596456260,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Dt(),l().ULS.traceTag(596456261,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${$t(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return l().ULS.traceTag(596456258,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&l().ULS.traceTag(596456259,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${jt(this.fulfillmentTimestamp)}. ${$t(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Tt(e),Nt.sequenceId+=1,this.sequenceId=Nt.sequenceId,this.creationTimestamp=Dt(),l().ULS.traceTag(596456225,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${jt(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{l().ULS.traceTag(596456226,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${jt(Dt())}`),this.internalResolve=e,this.internalReject=t}))}}function Ut(){return new Ht}Nt.sequenceId=0;class Ht{getDeferredPromise(e){const t=Tt(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return l().ULS.traceTag(596456218,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;l().ULS.traceTag(596456219,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=Ft(e);if(this.getDeferredPromise(t.id))throw new I("A deferred promise already exists in the cache for the specified id","id",t.id);const r=Tt(t.id);return this.deferredResultMessagePromiseCache[r]=t,l().ULS.traceTag(596456220,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void l().ULS.traceTag(596456221,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=Tt(e);delete this.deferredResultMessagePromiseCache[t],l().ULS.traceTag(596456222,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(l().ULS.traceTag(596456223,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){l().ULS.traceTag(596456224,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function zt(e){if(!e)throw new A(d,"validator");const t={deserialize:t=>function(e,t){if(!e)throw new A(d,"incomingMessage");if(!t)throw new A(d,"validator");if(0===e.length)throw new I("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new I("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new I("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new I("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)};return t}function Jt(e){if(!e)throw new A(d,"validator");const t={serialize:t=>function(e,t){if(!e)throw new A(d,"outgoingMessage");if(!t)throw new A(d,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new I("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return l().ULS.traceTag(596452375,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)};return t}const Gt="initmessageid",Vt="unknownmessageid",Bt="CreatorOrigin";function Kt(e){if(!e)throw new A(d,"remoteWindow");if(!("window"in e)||!e.window)throw new A(d,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new A(d,"remoteWindow.windowOrigin");const t=gt(e.windowOrigin);return{window:e.window,windowOrigin:t}}class qt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(H([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new A(d,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw l().ULS.shipAssertTag(596121484,s.nh.msoulscat_ES_EWAJS,!1,e),new M(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Lt(o)}}function Zt(){return Xt}const Xt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function Yt(e,t,r){return new tr(e,t,r)}function Qt(e,t,r){return new tr(e,t,r)}const er="message";class tr{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Zt().removeEventListener(er,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return l().ULS.traceTag(596452370,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return l().ULS.traceTag(596452371,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return l().ULS.traceTag(596452372,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return l().ULS.traceTag(596452373,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){l().ULS.traceTag(596452374,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${s.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){l().ULS.traceTag(596452184,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${s.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{l().ULS.traceTag(595985880,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to process incoming message. ${s.Wp.getStringifiedError(e)}`)}))}catch(e){l().ULS.traceTag(596452186,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to process incoming message. ${s.Wp.getStringifiedError(e)}`)}else l().ULS.traceTag(596452185,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new A(d,"deserializer");if(!t)throw new A(d,"handler");if(!r)throw new A(d,"windowRPC");this.disposableImplementationExtension=Lt("WindowRPCReceiverInternal"),this.remoteWindow=Kt(r.remoteWindow),Zt().addEventListener(er,this.windowMessageHandler)}}function rr(e,t){return new nr(e,t)}function or(e,t){return new nr(e,t)}class nr{postMessage(e){if(!e)throw new A(d,"outgoingMessage");if(!this.remoteWindow.window)throw new M("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new M("The remote window does not support postMessage");const t=this.serializer.serialize(e);re().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new A(d,"serializer");if(!t)throw new A(d,"windowRPC");this.disposableImplementationExtension=Lt("WindowRPCSenderInternal"),this.remoteWindow=Kt(t.remoteWindow)}}const ar="OfficeOnlineCCP_",ir=ar+"Metadata_",sr=ar+"Data_",cr="_LocalStorageChangedFlag";function lr(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch{return!1}}function ur(e){return sr+e}function dr(e){return ir+e}function pr(e){return dr(e)+cr}class fr{constructor(){this.copyStatus=gr.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class mr{profilingMessage(e){const t=s.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=s.TZ.timeStamp()}}var gr;function hr(){return{}}function yr(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}function br(e){try{l().ULS.traceTag(595716237,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Attempting to create clipboard storage type '${je.LocalStorage}'`);const t=new Sr(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(gr||(gr={}));class Sr{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),l().ULS.traceTag(595716238,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:d}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(Ae());try{const e=JSON.parse(t);if(!e||0===Ie(e))return Promise.resolve(Ae());const r=xe(e);return Promise.resolve(r)}catch(e){return Promise.resolve(Ae())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),l().ULS.traceTag(595716239,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.set: item count=${Me(e)}'; commandParameters.id='${t?t.id:d}'`),0===Me(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+cr}`,o=Et();return l().ULS.traceTag(595654546,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[de,fe,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new N(y.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new N(y.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=je.LocalStorage,this.disposableImplementationExtension=Lt("LocalStorageClipboardStorage")}}function _r(e){return l().ULS.traceTag(595716236,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Attempting to create clipboard strategy type '${h.LocalStorage}' with localStorageKey: '${e}'`),(new Cr).initialize(br(e))}class Cr extends Wt{constructor(e){super(h.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class wr{onStorageChanged(e){l().ULS.shipAssertTag(595716249,s.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),l().ULS.traceTag(595716288,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),l().ULS.traceTag(595716289,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{l().ULS.traceTag(595716295,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return l().ULS.traceTag(595715525,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),l().ULS.traceTag(595716232,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{l().ULS.traceTag(595716233,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return l().ULS.traceTag(595715526,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(l().ULS.traceTag(595715527,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return l().ULS.traceTag(595715528,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=Ft(),r=new Date,o=setInterval((()=>{const n=(new Date).getTime()-r.getTime();l().ULS.traceTag(595715529,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),l().ULS.traceTag(595716234,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(o),l().ULS.traceTag(595716235,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}var Er=r(996);const vr="\t",Tr="\n",Pr="\r",Ar=new RegExp(`(${Tr}${Pr})|(${Pr}${Tr})|(${Pr})`,"g"),Ir=new RegExp(`(${vr})`,"g"),Mr=10240,xr=new RegExp("<","g"),kr="&lt;",Or=new RegExp(">","g"),Lr="&gt;",Wr="div",Rr="pre",Fr="table",Dr="tr",jr="td",$r="\x3c!--StartFragment--\x3e",Nr="\x3c!--EndFragment--\x3e",Ur=$r.length,Hr=Nr.length,zr=`Version:0.9${Tr}StartHTML:0000000100${Tr}EndHTML:{EndHTML0}${Tr}StartFragment:0000000134${Tr}EndFragment:{EndFragm}${Tr}<html>${Tr}<body>${Tr}${$r}${Tr}`,Jr=`${Nr}${Tr}</body>${Tr}</html>`,Gr="0000000000",Vr=7,Br="data-ccp-timestamp",Kr=0;function qr(e){return e?e.replace(Ar,Tr):e}function Zr(e){return e?e.length<=Mr?e:e.substr(0,Mr):d}function Xr(e){var t;const r=function(e){return e?e.replace(Ar,`</${jr}></${Dr}><${Dr}><${jr}>`):e}((t=io(e))?t.replace(Ir,`</${jr}><${jr}>`):t);return`<${Fr}><${Dr}><${jr}>${r}</${jr}></${Dr}></${Fr}>`}function Yr(e,t,r){if(r!==Kr&&!r)throw new A(d,"timestamp");if(isNaN(r))throw new I(d,"timestamp",r.toString());const o=function(e,t,r){return`<${e} ${Br}='${r}'>${t}</${e}>`}(e,Xr(t),r);return ro(o)}function Qr(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=eo(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(Pr),t.push(Tr);const o=eo(r[e]);t.push(o)}}return t.join("")}function eo(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push(vr),t.push(r[e].innerText)}return t.join("")}function to(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Br)}function ro(e){if(!Y()||ee())return e;const t=Gr.length,r=zr.length+e.length+Jr.length;let o=(r-Jr.length).toString();if(o.length<t&&(o=Gr.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be ${t}`;throw l().ULS.shipAssertTag(596128536,s.nh.msoulscat_ES_EWAJS,!1,e),new N(y.UnexpectedClipboardTextHtmlContentLength,e)}let n=(r-Vr).toString();if(n.length<t&&(n=Gr.substr(0,t-n.length)+n),n.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be ${t}`;throw l().ULS.shipAssertTag(596128537,s.nh.msoulscat_ES_EWAJS,!1,e),new N(y.UnexpectedClipboardTextHtmlContentLength,e)}const a=zr.replace("{EndHTML0}",n).replace("{EndFragm}",o)+e+Jr;return l().ULS.shipAssertTag(596128538,s.nh.msoulscat_ES_EWAJS,a.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${a.length} differs from the expected length of ${r}`),a}function oo(e){if(!e)return d;if(!e.trim())return e;const t=e.indexOf($r),r=e.indexOf(Nr);if(t<0||r<0||t>r)return e;const o=t+Ur,n=r-o,a=e.indexOf($r,o),i=e.indexOf(Nr,r+Hr);return a>=0||i>=0?e:e.substr(o,n)}function no(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new A(d,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,Br);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==Kr||isNaN(r)?void 0:r}function ao(e){if(!e||!e.trim())return;const t=new DOMParser,r=Er.domPurifyPolicyHtml.createHTML(e),o=t.parseFromString(r,"text/html"),n=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void l().ULS.shipAssertTag(595683460,s.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";l().ULS.traceTag(595683457,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(o);if(void 0!==n)return n;const a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(o);return void 0!==a?a:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(o)?"Google Docs":void 0}function io(e){return e?e.replace(xr,kr).replace(Or,Lr):d}function so(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}function co(e,t,r){return new lo(e,t,r)}class lo{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new M("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new D(b.MissingArgumentError,"Missing commandParameters argument",new A(d,"commandParameters")));let t,r;this.initialClipboardStrategyType=e.dataClipboardStrategyType,t=new fr;try{t.id=vt(),l().ULS.traceTag(595937123,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),l().ULS.traceTag(595937152,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(Ee,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?gr.Completed:gr.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?l().ULS.traceTag(595734742,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):l().ULS.traceTag(595734743,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.onCopy: catching error and no copy context during serialize. CopyCommandId: ${e?.id}`),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(l().ULS.traceTag(504715104,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.onCopy: Write to clipboard completed for both sync and async phase. CopyId: ${t?.id}.`),this.copyCompleteCleanup(t,e),t)),(r=>{l().ULS.traceTag(595734747,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: Error in writeClipboardItems. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}`);let o=r;return this.copyCompleteCleanup(t,e),o||(l().ULS.shipAssertTag(595854806,s.nh.msoulscat_ES_EWAJS,!1,`copyPasteFlowManager.onCopy: promise rejected without error. CopyId: ${t?.id}.`),o=new D(b.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),l().ULS.traceTag(596456160,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. CopyId: ${t?.id}. Exception: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new D(b.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new mr;try{if(!e)return Promise.reject(new j(S.MissingArgumentError,"Missing commandParameters argument",new A(d,"commandParameters")));this.initialClipboardStrategyType=e.dataClipboardStrategyType,e.isTimestampStoredInSystemClipboard=!0,t.id=Et(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=Ae(),t.isClipboardInaccessible=!1,l().ULS.traceTag(595685636,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?l().ULS.traceTag(595937154,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):l().ULS.traceTag(595730637,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,n=!1;return e.skipClipboardAccess?(l().ULS.traceTag(595685637,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(l().ULS.traceTag(595685638,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(Ee);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==gr.Completed&&e?.lastCopy?.copyStatus===gr.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(ye,m))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===S.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(l().ULS.traceTag(595685639,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(n||e.beforePaste&&e.beforePaste(t),e))).then((r=>{if(l().ULS.traceTag(595685640,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("getPasteFlowHandler_then")),t.clipboardItems?.getItem(ye)!==m&&!t.isSameSession&&(!e.isAsyncClipboardAPI||!this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==gr.Completed&&r.shouldWaitForCopyToComplete(t)){l().ULS.traceTag(595937155,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),l().ULS.traceTag(595683427,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(l().ULS.traceTag(595685642,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),l().ULS.traceTag(595882504,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return l().ULS.traceTag(595685643,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return l().ULS.traceTag(595940941,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{l().ULS.traceTag(595685644,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(ye)===m&&(l().ULS.traceTag(595685645,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(fe);if(void 0!==r){const e=ao(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(l().ULS.shipAssertTag(595858762,s.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new j(S.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return l().ULS.shipAssertTag(596456161,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${s.Wp.getStringifiedError(e)}`),Promise.reject(new j(S.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,l().ULS.traceTag(595734748,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):l().ULS.traceTag(595734749,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=Ae(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:$e.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(l().ULS.traceTag(596456162,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new $(_.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return l().ULS.traceTag(596456163,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${s.Wp.getStringifiedError(e)}`),Promise.reject(new $(_.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isAsyncClipboardEnhancementsEnabled(e){return this.isAsyncClipboardEnhancementsFGEnabled&&e===h.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:$e.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,l().ULS.traceTag(595937158,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):l().ULS.traceTag(595937025,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw l().ULS.shipAssertTag(596456192,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(b.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw l().ULS.shipAssertTag(596456193,s.nh.msoulscat_ES_EWAJS,!1,e),new D(b.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw l().ULS.shipAssertTag(596456194,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(b.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw l().ULS.shipAssertTag(596456195,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(e)}`),new D(b.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;l().ULS.traceTag(504715103,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.serialize: copyFlowHandler.beforeSerialize completed. CopyId: ${t?.id}.`);try{r=e.serialize(t)}catch(e){throw l().ULS.shipAssertTag(596456196,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize failed with an exception. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(e)}`),new D(b.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw l().ULS.shipAssertTag(596456197,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize should return a non null result. CopyId: ${t?.id}.`),new D(b.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return l().ULS.traceTag(504715102,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.serialize completed. CopyId: ${t?.id}.`),r}setClipboardSync(e,t,r){try{r?l().ULS.traceTag(595734750,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):l().ULS.traceTag(595734751,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=Ae()),this.clipboardStrategy.set(o,t).catch((e=>{if(l().ULS.traceTag(596456198,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===y.ClipboardIsInaccessible)return Promise.reject(new D(b.ClipboardIsInaccessible,t.message,t));if(t.reason===y.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new D(b.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===y.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new D(b.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new D(b.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return l().ULS.shipAssertTag(596456199,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new D(b.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return l().ULS.traceTag(595734752,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(l().ULS.traceTag(505794970,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&e.setItem(Ee,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:gr.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const n={...t};return n.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&(n.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(n.isKeyboardEvent=!1,n.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,n).catch((e=>(l().ULS.traceTag(596456200,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===y.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new D(b.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{l().ULS.traceTag(505794969,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=n.isTimestampStoredInSystemClipboard}))}catch(e){return l().ULS.shipAssertTag(596456201,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Exception: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new D(b.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,l().ULS.traceTag(596456202,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. CopyId: ${r?.id}. Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new D(b.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(l().ULS.traceTag(595734753,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===Me(e)&&(l().ULS.traceTag(596456204,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(l().ULS.traceTag(596456203,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return this.isAsyncClipboardEnhancementsEnabled(e?.dataClipboardStrategyType)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=gr.SynchronousPhaseCompleted,l().ULS.traceTag(595937153,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((r=>{if(t?l().ULS.traceTag(595734744,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: Error in setClipboardSync. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}`):l().ULS.traceTag(595734745,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: no copy context. CopyCommandId: ${e?.id}`),r&&r.reason){const e=r.reason;if(e===b.SuccessiveCutCopyOverridingPendingCutCopy||e===b.BlockedSynchronousCutCopy||e===b.CopyOperationCancelled||this.initialClipboardStrategyType===h.AsyncSystemClipboard&&e===b.ClipboardIsInaccessible)return l().ULS.traceTag(595734746,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. CopyId: ${t?.id}. Rejecting the promise: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(r)}return l().ULS.traceTag(596456159,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){l().ULS.traceTag(595685646,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return l().ULS.traceTag(595685647,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(l().ULS.traceTag(595685648,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(l().ULS.traceTag(596456206,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new j(S.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new j(S.ClipboardIsEmpty,d)))))),(e=>{if(l().ULS.traceTag(596456207,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return l().ULS.traceTag(577249542,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return C(e,y.ClipboardIsInaccessible)?Promise.reject(new j(S.ClipboardIsInaccessible,r.message,r)):C(e,y.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new j(S.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):C(e,y.AsyncClipboardReadFailure)?Promise.reject(new j(S.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new j(S.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(l().ULS.shipAssertTag(596456205,s.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new j(S.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new j(S.ReadFromClipboardReturnNullOrUndefined,d))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw l().ULS.shipAssertTag(596456208,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${s.Wp.getStringifiedError(e)}`),new j(S.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw l().ULS.shipAssertTag(596456209,s.nh.msoulscat_ES_EWAJS,!1,e),new j(S.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return l().ULS.traceTag(595683456,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=s.Wp.getStringifiedError(e);return l().ULS.traceTag(596456210,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new j(S.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(l().ULS.traceTag(595734754,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=gr.Completed,l().ULS.traceTag(595937159,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):l().ULS.traceTag(595734755,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):l().ULS.traceTag(595734784,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.copyCompleteCleanup: no copy context. CopyCommandId: ${t?.id}`)}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(l().ULS.traceTag(595937160,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(l().ULS.traceTag(595940942,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${s.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===gr.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(l().ULS.shipAssertTag(595937161,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(S.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===gr.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return l().ULS.traceTag(595937162,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=Ft(),n=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:n,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,l().ULS.traceTag(595937163,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){l().ULS.traceTag(595937164,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new j(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){l().ULS.traceTag(595937165,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?l().ULS.traceTag(595734785,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):l().ULS.traceTag(595734786,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(l().ULS.traceTag(595734787,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new D(b.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&l().ULS.traceTag(595734788,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(l().ULS.traceTag(595937166,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(l().ULS.traceTag(595937167,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(l().ULS.traceTag(595734789,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(S.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===gr.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(l().ULS.traceTag(595734790,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(l().ULS.traceTag(595724049,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(S.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?l().ULS.traceTag(595734791,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):l().ULS.traceTag(595734792,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===gr.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isAsyncClipboardEnhancementsFGEnabled=!1,!r)throw new A(d,"logger");u(r),l().ULS.shipAssertTag(596456157,s.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),l().ULS.shipAssertTag(596456158,s.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),l().ULS.shipAssertTag(596456156,s.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isAsyncClipboardEnhancementsFGEnabled=((e,t=!1)=>n?n.getBooleanFeatureGate(e,t):t)("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1)}}var uo=r(107);class po{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const fo=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,r,o){this.externalLogger.sendTraceTag(e,t,r,o)}debugAssertTag(e,t,r,o){this.externalLogger.debugAssertTag(e,t,r,o)}shipAssertTag(e,t,r,o){this.externalLogger.shipAssertTag(e,t,r,o)}forwardFeedbackCacheLogs(){this.externalLogger.forwardFeedbackCacheLogs?.()}constructor(){this.externalLogger=new po}};var mo,go;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleLicensing=4013]="msoulscat_AIHub_CreateModuleLicensing",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(mo||(mo={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(go||(go={}));var ho=r(713),yo=r(645);let bo,So=!1;async function _o(e){if(So)return fo.sendTraceTag(504452609,mo.msoulscat_ES_EWAJS,go.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker already initialized"),null;const t=(0,yo.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.OfficeVSO_10358639_EnableTTPolicyWorkerConstructor3");try{const r={reportProgress(e){bo&&bo(e)}},o=await(0,ho.createWorker)({id:"HtmlMinifierWorker",createMode:"Thread",isTrustedTypesPolicyEnabled:t},{scriptUrl:e,insideInitName:"htmlMinifierWorker.htmlMinifierWorkerServiceInit"},(()=>r));return o?(So=!0,fo.sendTraceTag(504452579,mo.msoulscat_ES_EWAJS,go.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: worker endpoint created"),{minifyHtml:async(e,t)=>(bo=t,await o.call.minifyHtml(e))}):(fo.sendTraceTag(504452608,mo.msoulscat_ES_EWAJS,go.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker endpoint not initialized"),null)}catch(e){return fo.sendTraceTag(504451539,mo.msoulscat_ES_EWAJS,go.Info,`HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Failed to create worker - ${e}`),null}}function Co(e){i.setFeatureGateManager(e)}}(),copyPasteInfra=o}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/copyPasteInfra.min.js.map/d814b50a0e92da35ca729ac4cfffbca2/copyPasteInfra.min.js.map